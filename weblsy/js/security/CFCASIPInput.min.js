var goog=goog||{};goog.global=this;goog.exportPath_=function(name,opt_object,opt_objectToExportTo){var parts=name.split(".");var cur=opt_objectToExportTo||goog.global;if(!(parts[0]in cur)&&cur.execScript)cur.execScript("var "+parts[0]);for(var part;parts.length&&(part=parts.shift());)if(!parts.length&&opt_object!==undefined)cur[part]=opt_object;else if(cur[part])cur=cur[part];else cur=cur[part]={}};
goog.exportSymbol=function(publicPath,object,opt_objectToExportTo){goog.exportPath_(publicPath,object,opt_objectToExportTo)};goog.exportProperty=function(object,publicName,symbol){object[publicName]=symbol};var JAVASCRIPT_PC_SIP_VERSION="3.2.1.2";var SIP_TYPE_SYSTEM_KEYBOARD=0;var SIP_TYPE_SOFT_KEYBOARD=1;var SIP_TYPE_SOFT_AND_SYSTEM_KEYBOARD=2;var DEFAULT_MIN_LENGTH=6;var DEFAULT_MAX_LENGTH=8;var DIGITAL_NUMBER_ASCLL_FIRST=48;var CIPHER_TYPE_SM2=0;var CIPHER_TYPE_RSA=1;var RANDOM_NONE=0;var RANDOM_DIGITAL=1;var RANDOM_LETTER=2;var RANDOM_DIGITAL_LETTER=3;var CFCA_OK=0;var CFCA_ERROR_INVALID_PARAMETER=4097;var CFCA_ERROR_INVALID_SIP_HANDLE_ID=4098;var CFCA_ERROR_INPUT_LENGTH_OUT_OF_RANGE=4099;
var CFCA_ERROR_INPUT_VALUE_IS_NULL=4100;var CFCA_ERROR_SERVER_RANDOM_INVALID=4101;var CFCA_ERROR_SERVER_RANDOM_IS_NULL=4102;var CFCA_ERROR_INPUT_VALUE_OR_SERVER_RANDOM_TOO_LONG=4103;var CFCA_ERROR_INPUT_VALUE_NOT_MATCH_REGEX=4104;var CFCA_ERROR_KEY_BOARD_TYPE=4105;var CFCA_ERROR_DONE_CALL_BACK_FORMMAT=4106;var CFCA_ERROR_RSA_ENCRYPT_FAILED=4107;var CFCA_ERROR_NOT_MATCH_INPUT_REGEX=4108;var CFCA_ERROR_SERVER_RANDOM_TOO_SHORT=4109;var CFCA_ERROR_SERVER_RANDOM_WITH_INPUT=4110;
var CFCA_ERROR_SM2_ENCRYPT_FAILED=4111;var CFCA_ERROR_SM2_VERIFY_FAILED=4112;var CFCA_ERROR_CIPHER_TYPE=4113;var CFCA_ERROR_SM2_PUBLIC_KEY_LENGTH=4114;var CFCA_ERROR_SM2_SIGNATURE_LENGTH=4115;var CFCA_ERROR_SM2_PUBLIC_KEY_FORMMAT=4116;var CFCA_ERROR_SIGNATURE_INVALID=4117;var CFCA_ERROR_PUBLIC_KEY_INVALID=4118;var CFCA_ERROR_PUBLIC_KEY_IS_NULL=4119;var CFCA_ERROR_HASH_ERROR=4120;var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64padchar="=";function hex2b64(a){var b,c,d="";for(b=0;b+3<=a.length;b+=3)c=parseInt(a.substring(b,b+3),16),d+=b64map.charAt(c>>6)+b64map.charAt(c&63);b+1==a.length?(c=parseInt(a.substring(b,b+1),16),d+=b64map.charAt(c<<2)):b+2==a.length&&(c=parseInt(a.substring(b,b+2),16),d+=b64map.charAt(c>>2)+b64map.charAt((c&3)<<4));for(;0<(d.length&3);)d+=b64padchar;return d}
function b64tohex(a){var b="",c,d=0,e,f;for(c=0;c<a.length&&a.charAt(c)!=b64padchar;++c)f=b64map.indexOf(a.charAt(c)),0>f||(0==d?(b+=int2char(f>>2),e=f&3,d=1):1==d?(b+=int2char(e<<2|f>>4),e=f&15,d=2):2==d?(b+=int2char(e),b+=int2char(f>>2),e=f&3,d=3):(b+=int2char(e<<2|f>>4),b+=int2char(f&15),d=0));1==d&&(b+=int2char(e<<2));return b}function b64toBA(a){a=b64tohex(a);var b,c=[];for(b=0;2*b<a.length;++b)c[b]=parseInt(a.substring(2*b,2*b+2),16);return c}
function bytes2b64(a){var b,c=0,d="";for(b=0;b+3<=a.length;b+=3)c=(a[b]&255)<<16^(a[b+1]&255)<<8^a[b+2]&255,d+=b64map.charAt(c>>>18)+b64map.charAt((c&258048)>>>12)+b64map.charAt((c&4032)>>>6)+b64map.charAt(c&63);b==a.length-1?(c=a[b]&255,d+=b64map.charAt((c&252)>>>2)+b64map.charAt((c&3)<<4)):b+1==a.length-1&&(c=(a[b]&255)<<8^a[b+1]&255,d+=b64map.charAt((c&64512)>>>10)+b64map.charAt((c&1008)>>>4)+b64map.charAt((c&15)<<2));for(;0<(d.length&3);)d+=b64padchar;return d}
function convertb64Block(a){var b=[];4==a.length?(b.push((a[0]&63)<<2^(a[1]&48)>>>4),b.push((a[1]&15)<<4^(a[2]&60)>>>2),b.push((a[2]&3)<<6^a[3]&255)):3==a.length?(b.push((a[0]&63)<<2^(a[1]&48)>>>4),b.push((a[1]&15)<<4^(a[2]&60)>>>2)):2==a.length&&b.push((a[0]&63)<<2^(a[1]&48)>>>4);return b}
function b64tobytes(a){var b=[],c;for(c=0;c<a.length;c+=4){var d=[],e=b64map.indexOf(a.charAt(c));if(!(0>e||(d.push(e),e=b64map.indexOf(a.charAt(c+1)),0>e))){d.push(e);e=a.charAt(c+2);if(e==b64padchar){b=b.concat(convertb64Block(d));break}else{e=b64map.indexOf(e);if(0>e)continue;d.push(e)}e=a.charAt(c+3);if(e==b64padchar){b=b.concat(convertb64Block(d));break}else{e=b64map.indexOf(e);if(0>e)continue;d.push(e)}b=b.concat(convertb64Block(d))}}return b}
var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;b&&c.mixIn(b);c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)});c.init.prototype=c;c.$super=this;return c},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},
clone:function(){return this.init.prototype.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var b=
this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-c%4*8;b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);a.words=this.words.slice(0);return a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return new f.init(c,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,
c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new f.init(c,b/2)}},k=g.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new f.init(c,b)}},l=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(k.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");
}},parse:function(a){return k.parse(unescape(encodeURIComponent(a)))}},x=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new f.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=l.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=e/(4*g),h=b?a.ceil(h):a.max((h|0)-this._minBufferSize,0);b=h*g;e=a.min(4*b,e);if(b){for(var k=0;k<b;k+=g)this._doProcessBlock(d,k);k=d.splice(0,b);c.sigBytes-=
e}return new f.init(k,e)},clone:function(){var a=e.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});d.Hasher=x.extend({cfg:e.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){x.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,
c){return(new v.HMAC.init(a,c)).finalize(b)}}});var v=c.algo={};return c}(Math);
(function(){var a=CryptoJS,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,e=a.sigBytes,f=this._map;a.clamp();a=[];for(var g=0;g<e;g+=3)for(var h=(b[g>>>2]>>>24-g%4*8&255)<<16|(b[g+1>>>2]>>>24-(g+1)%4*8&255)<<8|b[g+2>>>2]>>>24-(g+2)%4*8&255,k=0;4>k&&g+.75*k<e;k++)a.push(f.charAt(h>>>6*(3-k)&63));if(b=f.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var d=a.length,e=this._map,f=e.charAt(64);f&&(f=a.indexOf(f),-1!=f&&(d=f));for(var f=[],g=0,h=0;h<d;h++)if(h%
4){var k=e.indexOf(a.charAt(h-1))<<h%4*2,l=e.indexOf(a.charAt(h))>>>6-h%4*2;f[g>>>2]|=(k|l)<<24-g%4*8;g++}return b.create(f,g)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();
(function(a){function b(a,b,c,d,e,f,g){a=a+(b&c|~b&d)+e+g;return(a<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){a=a+(b&d|c&~d)+e+g;return(a<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){a=a+(b^c^d)+e+g;return(a<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){a=a+(c^(b|~d))+e+g;return(a<<f|a>>>32-f)+b}var f=CryptoJS,g=f.lib,h=g.WordArray,k=g.Hasher,g=f.algo,l=[];(function(){for(var b=0;64>b;b++)l[b]=4294967296*a.abs(a.sin(b+1))|0})();g=g.MD5=k.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,
2562383102,271733878])},_doProcessBlock:function(a,f){for(var g=0;16>g;g++){var h=f+g,k=a[h];a[h]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}var g=this._hash.words,h=a[f+0],k=a[f+1],B=a[f+2],C=a[f+3],E=a[f+4],w=a[f+5],u=a[f+6],D=a[f+7],F=a[f+8],H=a[f+9],G=a[f+10],I=a[f+11],J=a[f+12],M=a[f+13],K=a[f+14],L=a[f+15],r=g[0],p=g[1],n=g[2],q=g[3],r=b(r,p,n,q,h,7,l[0]),q=b(q,r,p,n,k,12,l[1]),n=b(n,q,r,p,B,17,l[2]),p=b(p,n,q,r,C,22,l[3]),r=b(r,p,n,q,E,7,l[4]),q=b(q,r,p,n,w,12,l[5]),n=b(n,q,r,p,u,17,l[6]),
p=b(p,n,q,r,D,22,l[7]),r=b(r,p,n,q,F,7,l[8]),q=b(q,r,p,n,H,12,l[9]),n=b(n,q,r,p,G,17,l[10]),p=b(p,n,q,r,I,22,l[11]),r=b(r,p,n,q,J,7,l[12]),q=b(q,r,p,n,M,12,l[13]),n=b(n,q,r,p,K,17,l[14]),p=b(p,n,q,r,L,22,l[15]),r=c(r,p,n,q,k,5,l[16]),q=c(q,r,p,n,u,9,l[17]),n=c(n,q,r,p,I,14,l[18]),p=c(p,n,q,r,h,20,l[19]),r=c(r,p,n,q,w,5,l[20]),q=c(q,r,p,n,G,9,l[21]),n=c(n,q,r,p,L,14,l[22]),p=c(p,n,q,r,E,20,l[23]),r=c(r,p,n,q,H,5,l[24]),q=c(q,r,p,n,K,9,l[25]),n=c(n,q,r,p,C,14,l[26]),p=c(p,n,q,r,F,20,l[27]),r=c(r,p,
n,q,M,5,l[28]),q=c(q,r,p,n,B,9,l[29]),n=c(n,q,r,p,D,14,l[30]),p=c(p,n,q,r,J,20,l[31]),r=d(r,p,n,q,w,4,l[32]),q=d(q,r,p,n,F,11,l[33]),n=d(n,q,r,p,I,16,l[34]),p=d(p,n,q,r,K,23,l[35]),r=d(r,p,n,q,k,4,l[36]),q=d(q,r,p,n,E,11,l[37]),n=d(n,q,r,p,D,16,l[38]),p=d(p,n,q,r,G,23,l[39]),r=d(r,p,n,q,M,4,l[40]),q=d(q,r,p,n,h,11,l[41]),n=d(n,q,r,p,C,16,l[42]),p=d(p,n,q,r,u,23,l[43]),r=d(r,p,n,q,H,4,l[44]),q=d(q,r,p,n,J,11,l[45]),n=d(n,q,r,p,L,16,l[46]),p=d(p,n,q,r,B,23,l[47]),r=e(r,p,n,q,h,6,l[48]),q=e(q,r,p,n,
D,10,l[49]),n=e(n,q,r,p,K,15,l[50]),p=e(p,n,q,r,w,21,l[51]),r=e(r,p,n,q,J,6,l[52]),q=e(q,r,p,n,C,10,l[53]),n=e(n,q,r,p,G,15,l[54]),p=e(p,n,q,r,k,21,l[55]),r=e(r,p,n,q,F,6,l[56]),q=e(q,r,p,n,L,10,l[57]),n=e(n,q,r,p,u,15,l[58]),p=e(p,n,q,r,M,21,l[59]),r=e(r,p,n,q,E,6,l[60]),q=e(q,r,p,n,I,10,l[61]),n=e(n,q,r,p,B,15,l[62]),p=e(p,n,q,r,H,21,l[63]);g[0]=g[0]+r|0;g[1]=g[1]+p|0;g[2]=g[2]+n|0;g[3]=g[3]+q|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<
24-e%32;var f=a.floor(d/4294967296);c[(e+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;c[(e+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360;b.sigBytes=4*(c.length+1);this._process();b=this._hash;c=b.words;for(d=0;4>d;d++)e=c[d],c[d]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;return b},clone:function(){var a=k.clone.call(this);a._hash=this._hash.clone();return a}});f.MD5=k._createHelper(g);f.HmacMD5=k._createHmacHelper(g)})(Math);
(function(){var a=CryptoJS,b=a.lib,c=b.Base,d=b.WordArray,b=a.algo,e=b.EvpKDF=c.extend({cfg:c.extend({keySize:4,hasher:b.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,e=c.hasher.create(),l=d.create(),x=l.words,v=c.keySize,c=c.iterations;x.length<v;){A&&e.update(A);var A=e.update(a).finalize(b);e.reset();for(var y=1;y<c;y++)A=e.finalize(A),e.reset();l.concat(A)}l.sigBytes=4*v;return l}});a.EvpKDF=function(a,b,c){return e.create(c).compute(a,
b)}})();
CryptoJS.lib.Cipher||function(a){var b=CryptoJS,c=b.lib,d=c.Base,e=c.WordArray,f=c.BufferedBlockAlgorithm,g=b.enc.Base64,h=b.algo.EvpKDF,k=c.Cipher=f.extend({cfg:d.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c);this._xformMode=a;this._key=b;this.reset()},reset:function(){f.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},
finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){return function(a){return{encrypt:function(b,c,d){return("string"==typeof c?m:y).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?m:y).decrypt(a,b,c,d)}}}}()});c.StreamCipher=k.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=b.mode={},x=c.BlockCipherMode=d.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,
b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}}),l=l.CBC=function(){function b(c,d,e){var f=this._iv;f?this._iv=a:f=this._prevBlock;for(var g=0;g<e;g++)c[d+g]^=f[g]}var c=x.extend();c.Encryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize;b.call(this,a,c,e);d.encryptBlock(a,c);this._prevBlock=a.slice(c,c+e)}});c.Decryptor=c.extend({processBlock:function(a,c){var d=this._cipher,e=d.blockSize,f=a.slice(c,c+
e);d.decryptBlock(a,c);b.call(this,a,c,e);this._prevBlock=f}});return c}(),v=(b.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,f=[],g=0;g<c;g+=4)f.push(d);c=e.create(f,c);a.concat(c)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};c.BlockCipher=k.extend({cfg:k.cfg.extend({mode:l,padding:v}),reset:function(){k.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,
this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var A=c.CipherParams=d.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),l=(b.format={}).OpenSSL={stringify:function(a){var b=
a.ciphertext;a=a.salt;return(a?e.create([1398893684,1701076831]).concat(a).concat(b):b).toString(g)},parse:function(a){a=g.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=e.create(b.slice(2,4));b.splice(0,4);a.sigBytes-=16}return A.create({ciphertext:a,salt:c})}},y=c.SerializableCipher=d.extend({cfg:d.extend({format:l}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);b=e.finalize(b);e=e.cfg;return A.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,
padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);return a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),b=(b.kdf={}).OpenSSL={execute:function(a,b,c,d){d||(d=e.random(8));a=h.create({keySize:b+c}).compute(a,d);c=e.create(a.words.slice(b),4*c);a.sigBytes=4*b;return A.create({key:a,iv:c,salt:d})}},m=c.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:b}),
encrypt:function(a,b,c,d){d=this.cfg.extend(d);c=d.kdf.execute(c,a.keySize,a.ivSize);d.iv=c.iv;a=y.encrypt.call(this,a,b,c.key,d);a.mixIn(c);return a},decrypt:function(a,b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt);d.iv=c.iv;return y.decrypt.call(this,a,b,c.key,d)}})}();
(function(){function a(){var a=this._S,b=this._i,c=this._j,b=(b+1)%256,c=(c+a[b])%256,d=a[b];a[b]=a[c];a[c]=d;this._i=b;this._j=c;return a[(a[b]+a[c])%256]}var b=CryptoJS,c=b.lib.StreamCipher,d=b.algo,e=d.RC4=c.extend({_doReset:function(){for(var a=this._key,b=a.words,a=a.sigBytes,c=this._S=[],d=0;256>d;d++)c[d]=d;for(var e=d=0;256>d;d++){var x=d%a,e=(e+c[d]+(b[x>>>2]>>>24-x%4*8&255))%256,x=c[d];c[d]=c[e];c[e]=x}this._i=this._j=0},_doProcessBlock:function(b,c){for(var d=0,e=0;4>e;e++){var l=b[c]>>>
24-8*e&255;if(0===l)break;var x=a.call(this),d=d|(l^x)<<24-8*e}b[c]=d},keySize:8,ivSize:0});b.RC4=c._createHelper(e);d=d.RC4Drop=e.extend({cfg:e.cfg.extend({drop:192}),_doReset:function(){e._doReset.call(this);for(var b=this.cfg.drop;0<b;b--)a.call(this)}});b.RC4Drop=c._createHelper(d)})();
(function(){var a=CryptoJS,b=a.lib,c=b.WordArray,d=b.Hasher,e=[],b=a.algo.SHA1=d.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],l=c[1],x=c[2],v=c[3],A=c[4],y=0;80>y;y++){if(16>y)e[y]=a[b+y]|0;else{var m=e[y-3]^e[y-8]^e[y-14]^e[y-16];e[y]=m<<1|m>>>31}m=(d<<5|d>>>27)+A+e[y];m=20>y?m+((l&x|~l&v)+1518500249):40>y?m+((l^x^v)+1859775393):60>y?m+((l&x|l&v|x&v)-1894007588):m+((l^x^
v)-899497514);A=v;v=x;x=l<<30|l>>>2;l=d;d=m}c[0]=c[0]+d|0;c[1]=c[1]+l|0;c[2]=c[2]+x|0;c[3]=c[3]+v|0;c[4]=c[4]+A|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;b[d>>>5]|=128<<24-d%32;b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296);b[(d+64>>>9<<4)+15]=c;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=d.clone.call(this);a._hash=this._hash.clone();return a}});a.SHA1=d._createHelper(b);a.HmacSHA1=d._createHmacHelper(b)})();
var ASN1HEX=new function(){this.getByteLengthOfL_AtObj=function(a,b){if("8"!=a.substring(b+2,b+3))return 1;var c=parseInt(a.substring(b+3,b+4));return 0==c?-1:0<c&&10>c?c+1:-2};this.getHexOfL_AtObj=function(a,b){var c=this.getByteLengthOfL_AtObj(a,b);return 1>c?"":a.substring(b+2,b+2+2*c)};this.getIntOfL_AtObj=function(a,b){var c=this.getHexOfL_AtObj(a,b);return""==c?-1:(8>parseInt(c.substring(0,1))?new BigInteger(c,16):new BigInteger(c.substring(2),16)).intValue()};this.getStartPosOfV_AtObj=function(a,
b){var c=this.getByteLengthOfL_AtObj(a,b);return 0>c?c:b+2*(c+1)};this.getHexOfV_AtObj=function(a,b){var c=this.getStartPosOfV_AtObj(a,b),d=this.getIntOfL_AtObj(a,b);return a.substring(c,c+2*d)};this.getHexOfTLV_AtObj=function(a,b){var c=a.substr(b,2),d=this.getHexOfL_AtObj(a,b),e=this.getHexOfV_AtObj(a,b);return c+d+e};this.getPosOfNextSibling_AtObj=function(a,b){var c=this.getStartPosOfV_AtObj(a,b),d=this.getIntOfL_AtObj(a,b);return c+2*d};this.getPosArrayOfChildren_AtObj=function(a,b){var c=[],
d=this.getStartPosOfV_AtObj(a,b);c.push(d);for(var e=this.getIntOfL_AtObj(a,b),f=d,g=0;;){f=this.getPosOfNextSibling_AtObj(a,f);if(null==f||f-d>=2*e)break;if(200<=g)break;c.push(f);g++}return c};this.getNthChildIndex_AtObj=function(a,b,c){return this.getPosArrayOfChildren_AtObj(a,b)[c]};this.getDecendantIndexByNthList=function(a,b,c){if(0==c.length)return b;var d=c.shift();b=this.getPosArrayOfChildren_AtObj(a,b);return this.getDecendantIndexByNthList(a,b[d],c)};this.getDecendantHexTLVByNthList=function(a,
b,c){b=this.getDecendantIndexByNthList(a,b,c);return this.getHexOfTLV_AtObj(a,b)};this.getDecendantHexVByNthList=function(a,b,c){b=this.getDecendantIndexByNthList(a,b,c);return this.getHexOfV_AtObj(a,b)}};ASN1HEX.getVbyList=function(a,b,c,d){b=this.getDecendantIndexByNthList(a,b,c);if(void 0===b)throw"can't find nthList object";if(void 0!==d&&a.substr(b,2)!=d)throw"checking tag doesn't match: "+a.substr(b,2)+"!="+d;return this.getHexOfV_AtObj(a,b)};
ASN1HEX.hextooidstr=function(a){var b=function(a,b){return a.length>=b?a:Array(b-a.length+1).join("0")+a},c=[],d=a.substr(0,2),d=parseInt(d,16);c[0]=new String(Math.floor(d/40));c[1]=new String(d%40);var e=a.substr(2);a=[];for(d=0;d<e.length/2;d++)a.push(parseInt(e.substr(2*d,2),16));for(var e=[],f="",d=0;d<a.length;d++)a[d]&128?f+=b((a[d]&127).toString(2),7):(f+=b((a[d]&127).toString(2),7),e.push(new String(parseInt(f,2))),f="");b=c.join(".");0<e.length&&(b=b+"."+e.join("."));return b};
"undefined"!=typeof KJUR&&KJUR||(KJUR={});"undefined"!=typeof KJUR.crypto&&KJUR.crypto||(KJUR.crypto={});
KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"};this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",
sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",
SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"};this.CRYPTOJSMESSAGEDIGESTNAME=
{md5:"CryptoJS.algo.MD5",sha1:"CryptoJS.algo.SHA1",sha224:"CryptoJS.algo.SHA224",sha256:"CryptoJS.algo.SHA256",sha384:"CryptoJS.algo.SHA384",sha512:"CryptoJS.algo.SHA512",ripemd160:"CryptoJS.algo.RIPEMD160"};this.getDigestInfoHex=function(a,b){if("undefined"==typeof this.DIGESTINFOHEAD[b])throw"alg not supported in Util.DIGESTINFOHEAD: "+b;return this.DIGESTINFOHEAD[b]+a};this.getPaddedDigestInfoHex=function(a,b,c){var d=this.getDigestInfoHex(a,b);a=c/4;if(d.length+22>a)throw"key is too short for SigAlg: keylen="+
c+","+b;b="00"+d;c="";a=a-4-b.length;for(d=0;d<a;d+=2)c+="ff";return"0001"+c+b};this.hashString=function(a,b){return(new KJUR.crypto.MessageDigest({alg:b})).digestString(a)};this.hashHex=function(a,b){return(new KJUR.crypto.MessageDigest({alg:b})).digestHex(a)};this.sha1=function(a){return(new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"})).digestString(a)};this.sha256=function(a){return(new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"})).digestString(a)};this.sha256Hex=function(a){return(new KJUR.crypto.MessageDigest({alg:"sha256",
prov:"cryptojs"})).digestHex(a)};this.sha512=function(a){return(new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"})).digestString(a)};this.sha512Hex=function(a){return(new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"})).digestHex(a)};this.md5=function(a){return(new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"})).digestString(a)};this.ripemd160=function(a){return(new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"})).digestString(a)};this.getCryptoJSMDByName=
function(a){}};
KJUR.crypto.MessageDigest=function(a){this.setAlgAndProvider=function(a,c){null!=a&&void 0===c&&(c=KJUR.crypto.Util.DEFAULTPROVIDER[a]);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(a)&&"cryptojs"==c){try{this.md=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[a]).create()}catch(d){throw"setAlgAndProvider hash alg set fail alg="+a+"/"+d;}this.updateString=function(a){this.md.update(a)};this.updateHex=function(a){a=CryptoJS.enc.Hex.parse(a);this.md.update(a)};this.digest=function(){return this.md.finalize().toString(CryptoJS.enc.Hex)};
this.digestString=function(a){this.updateString(a);return this.digest()};this.digestHex=function(a){this.updateHex(a);return this.digest()}}if(-1!=":sha256:".indexOf(a)&&"sjcl"==c){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+a+"/"+e;}this.updateString=function(a){this.md.update(a)};this.updateHex=function(a){a=sjcl.codec.hex.toBits(a);this.md.update(a)};this.digest=function(){var a=this.md.finalize();return sjcl.codec.hex.fromBits(a)};this.digestString=
function(a){this.updateString(a);return this.digest()};this.digestHex=function(a){this.updateHex(a);return this.digest()}}};this.updateString=function(a){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName;};this.updateHex=function(a){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName;};this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName;};this.digestString=function(a){throw"digestString(str) not supported for this alg/prov: "+
this.algName+"/"+this.provName;};this.digestHex=function(a){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName;};void 0!==a&&void 0!==a.alg&&(this.algName=a.alg,void 0===a.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))};
KJUR.crypto.Mac=function(a){this.setAlgAndProvider=function(a,c){null==a&&(a="hmacsha1");a=a.toLowerCase();if("hmac"!=a.substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+a;void 0===c&&(c=KJUR.crypto.Util.DEFAULTPROVIDER[a]);this.algProv=a+"/"+c;var d=a.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(d)&&"cryptojs"==c){try{var e=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[d]);this.mac=CryptoJS.algo.HMAC.create(e,this.pass)}catch(f){throw"setAlgAndProvider hash alg set fail hashAlg="+
d+"/"+f;}this.updateString=function(a){this.mac.update(a)};this.updateHex=function(a){a=CryptoJS.enc.Hex.parse(a);this.mac.update(a)};this.doFinal=function(){return this.mac.finalize().toString(CryptoJS.enc.Hex)};this.doFinalString=function(a){this.updateString(a);return this.doFinal()};this.doFinalHex=function(a){this.updateHex(a);return this.doFinal()}}};this.updateString=function(a){throw"updateString(str) not supported for this alg/prov: "+this.algProv;};this.updateHex=function(a){throw"updateHex(hex) not supported for this alg/prov: "+
this.algProv;};this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv;};this.doFinalString=function(a){throw"digestString(str) not supported for this alg/prov: "+this.algProv;};this.doFinalHex=function(a){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv;};void 0!==a&&(void 0!==a.pass&&(this.pass=a.pass),void 0!==a.alg&&(this.algName=a.alg,void 0===a.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,
this.provName)))};
KJUR.crypto.Signature=function(a){var b=null;this._setAlgNames=function(){this.algName.match(/^(.+)with(.+)$/)&&(this.mdAlgName=RegExp.$1.toLowerCase(),this.pubkeyAlgName=RegExp.$2.toLowerCase())};this._zeroPaddingOfSignature=function(a,b){for(var c="",g=b/4-a.length,h=0;h<g;h++)c+="0";return c+a};this.setAlgAndProvider=function(a,b){this._setAlgNames();if("cryptojs/jsrsa"!=b)throw"provider not supported: "+b;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(c){throw"setAlgAndProvider hash alg set fail alg="+
this.mdAlgName+"/"+c;}this.init=function(a,b){var c=null;try{c=void 0===b?KEYUTIL.getKey(a):KEYUTIL.getKey(a,b)}catch(d){throw"init failed:"+d;}if(!0===c.isPrivate)this.prvKey=c,this.state="SIGN";else if(!0===c.isPublic)this.pubKey=c,this.state="VERIFY";else throw"init failed.:"+c;};this.initSign=function(a){"string"==typeof a.ecprvhex&&"string"==typeof a.eccurvename?(this.ecprvhex=a.ecprvhex,this.eccurvename=a.eccurvename):this.prvKey=a;this.state="SIGN"};this.initVerifyByPublicKey=function(a){"string"==
typeof a.ecpubhex&&"string"==typeof a.eccurvename?(this.ecpubhex=a.ecpubhex,this.eccurvename=a.eccurvename):a instanceof KJUR.crypto.ECDSA?this.pubKey=a:a instanceof RSAKey&&(this.pubKey=a);this.state="VERIFY"};this.initVerifyByCertificatePEM=function(a){var b=new X509;b.readCertPEM(a);this.pubKey=b.subjectPublicKeyRSA;this.state="VERIFY"};this.updateString=function(a){this.md.updateString(a)};this.updateHex=function(a){this.md.updateHex(a)};this.sign=function(){this.sHashHex=this.md.digest();if("undefined"!=
typeof this.ecprvhex&&"undefined"!=typeof this.eccurvename)this.hSign=(new KJUR.crypto.ECDSA({curve:this.eccurvename})).signHex(this.sHashHex,this.ecprvhex);else if("rsaandmgf1"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if("rsa"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof KJUR.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);
else if(this.prvKey instanceof KJUR.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;return this.hSign};this.signString=function(a){this.updateString(a);return this.sign()};this.signHex=function(a){this.updateHex(a);return this.sign()};this.verify=function(a){this.sHashHex=this.md.digest();if("undefined"!=typeof this.ecpubhex&&"undefined"!=typeof this.eccurvename)return(new KJUR.crypto.ECDSA({curve:this.eccurvename})).verifyHex(this.sHashHex,
a,this.ecpubhex);if("rsaandmgf1"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,a,this.mdAlgName,this.pssSaltLen);if("rsa"==this.pubkeyAlgName||this.pubKey instanceof KJUR.crypto.ECDSA||this.pubKey instanceof KJUR.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,a);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;}}};this.init=function(a,b){throw"init(key, pass) not supported for this alg:prov="+this.algProvName;};this.initVerifyByPublicKey=
function(a){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName;};this.initVerifyByCertificatePEM=function(a){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName;};this.initSign=function(a){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName;};this.updateString=function(a){throw"updateString(str) not supported for this alg:prov="+this.algProvName;};this.updateHex=function(a){throw"updateHex(hex) not supported for this alg:prov="+
this.algProvName;};this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName;};this.signString=function(a){throw"digestString(str) not supported for this alg:prov="+this.algProvName;};this.signHex=function(a){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName;};this.verify=function(a){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName;};this.initParams=a;if(void 0!==a&&(void 0!==a.alg&&(this.algName=a.alg,this.provName=void 0===
a.prov?KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]:a.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==a.psssaltlen&&(this.pssSaltLen=a.psssaltlen),void 0!==a.prvkeypem)){if(void 0!==a.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{b=new RSAKey,b.readPrivateKeyFromPEMString(a.prvkeypem),this.initSign(b)}catch(c){throw"fatal error to load pem private key: "+c;}}};
KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};var _RE_HEXDECONLY=RegExp("");_RE_HEXDECONLY.compile("[^0-9a-f]","gi");
function _rsasign_getHexPaddedDigestInfoForString(a,b,c){a=KJUR.crypto.Util.hashString(a,c);return KJUR.crypto.Util.getPaddedDigestInfoHex(a,c,b)}function _zeroPaddingOfSignature(a,b){for(var c="",d=b/4-a.length,e=0;e<d;e++)c+="0";return c+a}function _rsasign_signString(a,b){var c=KJUR.crypto.Util.hashString(a,b);return this.signWithMessageHash(c,b)}
function _rsasign_signWithMessageHash(a,b){var c=KJUR.crypto.Util.getPaddedDigestInfoHex(a,b,this.n.bitLength()),c=parseBigInt(c,16),c=this.doPrivate(c).toString(16);return _zeroPaddingOfSignature(c,this.n.bitLength())}function _rsasign_signStringWithSHA1(a){return _rsasign_signString.call(this,a,"sha1")}function _rsasign_signStringWithSHA256(a){return _rsasign_signString.call(this,a,"sha256")}
function pss_mgf1_str(a,b,c){for(var d="",e=0;d.length<b;)d+=hextorstr(c(rstrtohex(a+String.fromCharCode.apply(String,[(e&4278190080)>>24,(e&16711680)>>16,(e&65280)>>8,e&255])))),e+=1;return d}function _rsasign_signStringPSS(a,b,c){a=rstrtohex(a);a=KJUR.crypto.Util.hashHex(a,b);void 0===c&&(c=-1);return this.signWithMessageHashPSS(a,b,c)}
function _rsasign_signWithMessageHashPSS(a,b,c){var d=hextorstr(a);a=d.length;var e=this.n.bitLength()-1,f=Math.ceil(e/8),g=function(a){return KJUR.crypto.Util.hashHex(a,b)};if(-1===c||void 0===c)c=a;else if(-2===c)c=f-a-2;else if(-2>c)throw"invalid salt length";if(f<a+c+2)throw"data too long";var h="";0<c&&(h=Array(c),(new SecureRandom).nextBytes(h),h=String.fromCharCode.apply(String,h));for(var k=hextorstr(g(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+d+h))),l=[],d=0;d<f-c-a-2;d+=1)l[d]=0;c=String.fromCharCode.apply(String,
l)+"\u0001"+h;g=pss_mgf1_str(k,c.length,g);h=[];for(d=0;d<c.length;d+=1)h[d]=c.charCodeAt(d)^g.charCodeAt(d);h[0]&=~(65280>>8*f-e&255);for(d=0;d<a;d++)h.push(k.charCodeAt(d));h.push(188);return _zeroPaddingOfSignature(this.doPrivate(new BigInteger(h)).toString(16),this.n.bitLength())}function _rsasign_getDecryptSignatureBI(a,b,c){var d=new RSAKey;d.setPublic(b,c);return d.doPublic(a)}
function _rsasign_getHexDigestInfoFromSig(a,b,c){return _rsasign_getDecryptSignatureBI(a,b,c).toString(16).replace(/^1f+00/,"")}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(a){for(var b in KJUR.crypto.Util.DIGESTINFOHEAD){var c=KJUR.crypto.Util.DIGESTINFOHEAD[b],d=c.length;if(a.substring(0,d)==c)return[b,a.substring(d)]}return[]}
function _rsasign_verifySignatureWithArgs(a,b,c,d){b=_rsasign_getHexDigestInfoFromSig(b,c,d);c=_rsasign_getAlgNameAndHashFromHexDisgestInfo(b);if(0==c.length)return!1;b=c[1];a=KJUR.crypto.Util.hashString(a,c[0]);return b==a}function _rsasign_verifyHexSignatureForMessage(a,b){var c=parseBigInt(a,16);return _rsasign_verifySignatureWithArgs(b,c,this.n.toString(16),this.e.toString(16))}
function _rsasign_verifyString(a,b){b=b.replace(_RE_HEXDECONLY,"");b=b.replace(/[ \n]+/g,"");var c=parseBigInt(b,16);if(c.bitLength()>this.n.bitLength())return 0;var c=this.doPublic(c).toString(16).replace(/^1f+00/,""),d=_rsasign_getAlgNameAndHashFromHexDisgestInfo(c);if(0==d.length)return!1;c=d[1];d=KJUR.crypto.Util.hashString(a,d[0]);return c==d}
function _rsasign_verifyWithMessageHash(a,b){b=b.replace(_RE_HEXDECONLY,"");b=b.replace(/[ \n]+/g,"");var c=parseBigInt(b,16);if(c.bitLength()>this.n.bitLength())return 0;c=this.doPublic(c).toString(16).replace(/^1f+00/,"");c=_rsasign_getAlgNameAndHashFromHexDisgestInfo(c);return 0==c.length?!1:c[1]==a}function _rsasign_verifyStringPSS(a,b,c,d){a=rstrtohex(a);a=KJUR.crypto.Util.hashHex(a,c);void 0===d&&(d=-1);return this.verifyWithMessageHashPSS(a,b,c,d)}
function _rsasign_verifyWithMessageHashPSS(a,b,c,d){var e=new BigInteger(b,16);if(e.bitLength()>this.n.bitLength())return!1;b=function(a){return KJUR.crypto.Util.hashHex(a,c)};a=hextorstr(a);var f=a.length,g=this.n.bitLength()-1,h=Math.ceil(g/8);if(-1===d||void 0===d)d=f;else if(-2===d)d=h-f-2;else if(-2>d)throw"invalid salt length";if(h<f+d+2)throw"data too long";for(var k=this.doPublic(e).toByteArray(),e=0;e<k.length;e+=1)k[e]&=255;for(;k.length<h;)k.unshift(0);if(188!==k[h-1])throw"encoded message does not end in 0xbc";
var k=String.fromCharCode.apply(String,k),l=k.substr(0,h-f-1),k=k.substr(l.length,f),x=65280>>8*h-g&255;if(0!==(l.charCodeAt(0)&x))throw"bits beyond keysize not zero";for(var v=pss_mgf1_str(k,l.length,b),g=[],e=0;e<l.length;e+=1)g[e]=l.charCodeAt(e)^v.charCodeAt(e);g[0]&=~x;f=h-f-d-2;for(e=0;e<f;e+=1)if(0!==g[e])throw"leftmost octets not zero";if(1!==g[f])throw"0x01 marker not found";return k===hextorstr(b(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+a+String.fromCharCode.apply(String,g.slice(-d)))))}
RSAKey.prototype.signWithMessageHash=_rsasign_signWithMessageHash;RSAKey.prototype.signString=_rsasign_signString;RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.sign=_rsasign_signString;RSAKey.prototype.signWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.signWithMessageHashPSS=_rsasign_signWithMessageHashPSS;
RSAKey.prototype.signStringPSS=_rsasign_signStringPSS;RSAKey.prototype.signPSS=_rsasign_signStringPSS;RSAKey.SALT_LEN_HLEN=-1;RSAKey.SALT_LEN_MAX=-2;RSAKey.prototype.verifyWithMessageHash=_rsasign_verifyWithMessageHash;RSAKey.prototype.verifyString=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verify=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage;
RSAKey.prototype.verifyWithMessageHashPSS=_rsasign_verifyWithMessageHashPSS;RSAKey.prototype.verifyStringPSS=_rsasign_verifyStringPSS;RSAKey.prototype.verifyPSS=_rsasign_verifyStringPSS;RSAKey.SALT_LEN_RECOVER=-2;
function des(a,b,c,d,e,f){var g=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],h=[-2146402272,-2147450880,
32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,
32800,-2147483648,-2146435040,-2146402272,1081344],k=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,
131592,8,134348808,131584],l=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],x=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,
1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],v=[536870928,541065216,
16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],A=[2097152,
69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],y=[268439616,4096,262144,268701760,268435456,
268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];a=des_createKeys(a);var m=0,B,C,E,w,u,D,F,H,G,I,J,
M,K=b.length,L=0,r=32==a.length?3:9;D=3==r?c?[0,32,2]:[30,-2,-2]:c?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2];2==f?b+="        ":1==f?(f=8-K%8,b+=String.fromCharCode(f,f,f,f,f,f,f,f),8==f&&(K+=8)):f||(b+="\x00\x00\x00\x00\x00\x00\x00\x00");tempresult=result="";1==d&&(F=e.charCodeAt(m++)<<24|e.charCodeAt(m++)<<16|e.charCodeAt(m++)<<8|e.charCodeAt(m++),G=e.charCodeAt(m++)<<24|e.charCodeAt(m++)<<16|e.charCodeAt(m++)<<8|e.charCodeAt(m++),m=0);for(;m<K;){w=b.charCodeAt(m++)<<24|b.charCodeAt(m++)<<
16|b.charCodeAt(m++)<<8|b.charCodeAt(m++);u=b.charCodeAt(m++)<<24|b.charCodeAt(m++)<<16|b.charCodeAt(m++)<<8|b.charCodeAt(m++);1==d&&(c?(w^=F,u^=G):(H=F,I=G,F=w,G=u));f=(w>>>4^u)&252645135;u^=f;w^=f<<4;f=(w>>>16^u)&65535;u^=f;w^=f<<16;f=(u>>>2^w)&858993459;w^=f;u^=f<<2;f=(u>>>8^w)&16711935;w^=f;u^=f<<8;f=(w>>>1^u)&1431655765;u^=f;w^=f<<1;w=w<<1|w>>>31;u=u<<1|u>>>31;for(B=0;B<r;B+=3){J=D[B+1];M=D[B+2];for(e=D[B];e!=J;e+=M)C=u^a[e],E=(u>>>4|u<<28)^a[e+1],f=w,w=u,u=f^(h[C>>>24&63]|l[C>>>16&63]|v[C>>>
8&63]|y[C&63]|g[E>>>24&63]|k[E>>>16&63]|x[E>>>8&63]|A[E&63]);f=w;w=u;u=f}w=w>>>1|w<<31;u=u>>>1|u<<31;f=(w>>>1^u)&1431655765;u^=f;w^=f<<1;f=(u>>>8^w)&16711935;w^=f;u^=f<<8;f=(u>>>2^w)&858993459;w^=f;u^=f<<2;f=(w>>>16^u)&65535;u^=f;w^=f<<16;f=(w>>>4^u)&252645135;u^=f;w^=f<<4;1==d&&(c?(F=w,G=u):(w^=H,u^=I));tempresult+=String.fromCharCode(w>>>24,w>>>16&255,w>>>8&255,w&255,u>>>24,u>>>16&255,u>>>8&255,u&255);L+=8;512==L&&(result+=tempresult,tempresult="",L=0)}return result+tempresult}
function des_createKeys(a){pc2bytes0=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964];pc2bytes1=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697];pc2bytes2=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272];pc2bytes3=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,
139264,2236416,134356992,136454144];pc2bytes4=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256];pc2bytes5=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488];pc2bytes6=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746];pc2bytes7=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,
537069568];pc2bytes8=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578];pc2bytes9=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488];pc2bytes10=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800];pc2bytes11=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744];
pc2bytes12=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128];pc2bytes13=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261];for(var b=8<a.length?3:1,c=Array(32*b),d=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],e,f,g=0,h=0,k,l=0;l<b;l++){left=a.charCodeAt(g++)<<24|a.charCodeAt(g++)<<16|a.charCodeAt(g++)<<8|a.charCodeAt(g++);right=a.charCodeAt(g++)<<24|a.charCodeAt(g++)<<16|a.charCodeAt(g++)<<8|a.charCodeAt(g++);k=(left>>>4^right)&252645135;
right^=k;left^=k<<4;k=(right>>>-16^left)&65535;left^=k;right^=k<<-16;k=(left>>>2^right)&858993459;right^=k;left^=k<<2;k=(right>>>-16^left)&65535;left^=k;right^=k<<-16;k=(left>>>1^right)&1431655765;right^=k;left^=k<<1;k=(right>>>8^left)&16711935;left^=k;right^=k<<8;k=(left>>>1^right)&1431655765;right^=k;left^=k<<1;k=left<<8|right>>>20&240;left=right<<24|right<<8&16711680|right>>>8&65280|right>>>24&240;right=k;for(var x=0;x<d.length;x++)d[x]?(left=left<<2|left>>>26,right=right<<2|right>>>26):(left=
left<<1|left>>>27,right=right<<1|right>>>27),left&=-15,right&=-15,e=pc2bytes0[left>>>28]|pc2bytes1[left>>>24&15]|pc2bytes2[left>>>20&15]|pc2bytes3[left>>>16&15]|pc2bytes4[left>>>12&15]|pc2bytes5[left>>>8&15]|pc2bytes6[left>>>4&15],f=pc2bytes7[right>>>28]|pc2bytes8[right>>>24&15]|pc2bytes9[right>>>20&15]|pc2bytes10[right>>>16&15]|pc2bytes11[right>>>12&15]|pc2bytes12[right>>>8&15]|pc2bytes13[right>>>4&15],k=(f>>>16^e)&65535,c[h++]=e^k,c[h++]=f^k<<16}return c}
function removePKCS7Padding(a){return a.substr(0,a.length-a.charCodeAt(a.length-1))}function stringToHexForDES(a){for(var b="",c="0123456789abcdef".split(""),d=0;d<a.length;d++)b+=c[a.charCodeAt(d)>>4]+c[a.charCodeAt(d)&15];return b}function hexToStringForDES(a){for(var b="",c=0;c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));return b}function arrayToStringForDES(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b}
if("undefined"===typeof SIPHandle)var SIPHandle={};function initSIPHandle(a){SIPHandle[a]={clientRandom:null,serverRandom:null,publicKey:null,inputRegex:null,matchRegex:null,maxLength:DEFAULT_MAX_LENGTH,minLength:DEFAULT_MIN_LENGTH,cipherType:CIPHER_TYPE_SM2,randomType:RANDOM_NONE,errorCode:CFCA_OK,encryptor:null,encryptedValue:new CryptoJS.lib.WordArray.init};return CFCA_OK}function getInnerEncryptedValueLength(a){return"undefined"===typeof SIPHandle[a]?-1:SIPHandle[a].encryptedValue.sigBytes}
function initSIPEncryptor(a){if("undefined"===typeof SIPHandle[a])return 4098;if(null===SIPHandle[a].serverRandom)return 4102;if(16>SIPHandle[a].serverRandom.length)return 4109;a=SIPHandle[a];var b=CryptoJS.enc.Latin1.parse(a.serverRandom.slice(0,16)),b=convertHelper(b.words,b.sigBytes),c=Array(16),d="";rng_get_bytes_without0(c,0,16);for(var e=0;e<c.length;e++)d+=(c[e]>>>4).toString(16),d+=(c[e]&15).toString(16);a.clientRandom=CryptoJS.enc.Hex.parse(d);d=[];for(e=0;16>e;e++){var f=(b[e]^c[e])&255;
d.push((f>>>4).toString(16));d.push((f&15).toString(16))}a.encryptor=CryptoJS.algo.RC4.createEncryptor(CryptoJS.enc.Hex.parse(d.join("")));return CFCA_OK}
function insertCharacter(a,b){if("undefined"===typeof SIPHandle[a])return 4098;if(null===SIPHandle[a].serverRandom)return 4102;if(getInnerEncryptedValueLength(a)>=SIPHandle[a].maxLength)return 4099;if(null!=SIPHandle[a].inputRegex&&b.match(SIPHandle[a].inputRegex)!=b)return 4108;if(null==SIPHandle[a].encryptor){var c=initSIPEncryptor(a);if(c!=CFCA_OK)return c}SIPHandle[a].encryptedValue.concat(SIPHandle[a].encryptor.finalize(b));return CFCA_OK}
function getCipherType(a){return"undefined"===typeof SIPHandle[a]?SIPHandle[a].errorCode=4098:SIPHandle[a].cipherType}function verifyRSASignature(a,b,c){if("undefined"===a||0>=a.length||"undefined"===b||0>=b.length||"undefined"===c||0>=c.length)return 4097;var d=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(2!=d.length)return!1;var e=ASN1HEX.getHexOfV_AtObj(a,d[0]);a=ASN1HEX.getHexOfV_AtObj(a,d[1]);d=new RSAKey;d.setPublic(e,a);return d.verifyString(b,c)}
function setPublicKey(a,b,c,d){if("undefined"===typeof SIPHandle[a])return 4098;if("undefined"===c||0>=c.length)return 4118;if("undefined"===d||0>=d.length)return 4117;if(CIPHER_TYPE_SM2<=b&&b<=CIPHER_TYPE_RSA)SIPHandle[a].cipherType=b;else return 4113;b=b64tohex(RSA_VERIFY_PUBLICKEY_PRODUCT);if(verifyRSASignature(b,c,d))SIPHandle[a].publicKey=c;else if(b=b64tohex(RSA_VERIFY_PUBLICKEY_TEST),verifyRSASignature(b,c,d))SIPHandle[a].publicKey=c;else return SIPHandle[a].publicKey=null,4118;return CFCA_OK}
function parseSM2PublicKey(a){if("undefined"===a||0>=a.length)return{retErrorCode:4114};var b=[],c=a.slice(0,64);a=a.slice(64,128);if(IsPointOnSM2Curve(c,a)){if("undefined"===c||64!=c.length||"undefined"===a||64!=a.length)return{retErrorCode:4114};b.push(c);b.push(a);return{ret:b,retX:c,retY:a,retErrorCode:CFCA_OK}}return{retErrorCode:4116}}
function setServerRandom(a,b){if("undefined"===typeof SIPHandle[a])return 4098;if(0<getInnerEncryptedValueLength(a))return 4110;SIPHandle[a].serverRandom=null==b||0==b.length?null:b;return initSIPEncryptor(a)}function getMaxLength(a){return SIPHandle[a].maxLength}function setMaxLength(a,b){if("undefined"===typeof SIPHandle[a])return 4098;if(0>b)return 4097;SIPHandle[a].maxLength=b;return CFCA_OK}
function setMinLength(a,b){if("undefined"===typeof SIPHandle[a])return 4098;if(0>b)return 4097;SIPHandle[a].minLength=b;return CFCA_OK}function getMinLength(a){return SIPHandle[a].minLength}function getRandomType(a){return SIPHandle[a].randomType}function setRandomType(a,b){if("undefined"===typeof SIPHandle[a])return 4098;if(b<RANDOM_NONE||b>RANDOM_DIGITAL_LETTER)return 4097;SIPHandle[a].randomType=b;return CFCA_OK}
function setInputRegex(a,b){if("undefined"===typeof SIPHandle[a])return 4098;SIPHandle[a].inputRegex=null==b||0==b.length?null:b;return CFCA_OK}function getInputRegex(a){return"undefined"===typeof SIPHandle[a]?4098:SIPHandle[a].inputRegex}function setMatchRegex(a,b){if("undefined"===typeof SIPHandle[a])return 4098;SIPHandle[a].matchRegex=null==b||0==b.length?null:b;return CFCA_OK}function getMatchRegex(a){return"undefined"===typeof SIPHandle[a]?4098:SIPHandle[a].matchRegex}
function RSAEncryptForArray(a,b){var c=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(2!=c.length)throw Error("RSA encrypt error.");var d=ASN1HEX.getHexOfV_AtObj(a,c[0]),c=ASN1HEX.getHexOfV_AtObj(a,c[1]),e=new RSAKey;e.setPublic(d,c);return e.encryptForArrayNoPadding(b)}
function getEncryptedValue(a){if("undefined"===typeof SIPHandle[a])return SIPHandle[a].errorCode=4098,null;if(null==SIPHandle[a].serverRandom)return SIPHandle[a].errorCode=4102,null;if(16>SIPHandle[a].serverRandom.length)return SIPHandle[a].errorCode=4109,null;if(null==SIPHandle[a].publicKey)return SIPHandle[a].errorCode=4119,null;if(0===SIPHandle[a].encryptedValue.sigBytes)return SIPHandle[a].errorCode=4100,null;var b=SIPHandle[a].encryptedValue.words,c=SIPHandle[a].encryptedValue.sigBytes;if(c<
SIPHandle[a].minLength||c>SIPHandle[a].maxLength)return SIPHandle[a].errorCode=4099,null;var d=SIPHandle[a].serverRandom.length.toString(),e=1==d.length?"0"+d+SIPHandle[a].serverRandom:d+SIPHandle[a].serverRandom;if(128<=e.length+c+2+1+16)return SIPHandle[a].errorCode=4104,null;d=Array(128);d[0]=0;d[1]=2;for(var f=0;f<e.length;f++)d[f+2]=e.charCodeAt(f);for(var f=convertHelper(SIPHandle[a].clientRandom.words,SIPHandle[a].clientRandom.sigBytes),g=2+e.length,h=0;h<f.length;h++)d[h+g]=f[h];g=126-e.length-
1-c-16;rng_get_bytes_without0(d,2+e.length+16,g);g=2+e.length+g+16;d[g]=0;g+=1;b=convertHelper(b,c);for(f=0;f<c;f++)d[f+g]=b[f];c=void 0;if(SIPHandle[a].cipherType==CIPHER_TYPE_RSA)c=hex2b64(RSAEncryptForArray(SIPHandle[a].publicKey,d)),SIPHandle[a].errorCode=CFCA_OK;else if(SIPHandle[a].cipherType==CIPHER_TYPE_SM2){if((e=parseSM2PublicKey(SIPHandle[a].publicKey))&&e.retErrorCode==CFCA_OK)b=e.retX,e=e.retY;else return 4119;d=SM2_encrypt(d,128,b,e);0==d.retErrorCode?(c=bytes2b64(d.retC),SIPHandle[a].errorCode=
CFCA_OK):SIPHandle[a].errorCode=4111}return c}function checkMatchRegex(a,b){if("undefined"===typeof SIPHandle[a])return!1;b=b||SIPHandle[a].matchRegex;var c=CryptoJS.algo.RC4.createDecryptor(SIPHandle[a].encryptor._key).finalize(SIPHandle[a].encryptedValue).toString(CryptoJS.enc.Latin1);if(0<b.length){var d=!1,e=c.match(b);if(e&&0<e.length)for(var f=0;f<e.length;f++)if(e[f]==c){d=!0;break}return d}return!0}
function getPasswordLength(a){return"undefined"===typeof SIPHandle[a]?4098:SIPHandle[a].encryptedValue.sigBytes}function getLengthIntensity(a){if("undefined"===typeof SIPHandle[a])return 4098;var b=SIPHandle[a].encryptedValue.sigBytes;return SIPHandle[a].minLength<=b&&b<=SIPHandle[a].maxLength?!0:!1}
function getPasswordHash(a){if("undefined"===typeof SIPHandle[a])return 4098;var b=CryptoJS.algo.RC4.createDecryptor(SIPHandle[a].encryptor._key).finalize(SIPHandle[a].encryptedValue).toString(CryptoJS.enc.Latin1),c="";b&&0<b.length?(c=CryptoJS.MD5(b).toString(),SIPHandle[a].errorCode=c&&0<c.length?CFCA_OK:4120):SIPHandle[a].errorCode=4120;return c}
function clearAllCharacters(a){if("undefined"===typeof SIPHandle[a])return 4098;SIPHandle[a].encryptedValue=new CryptoJS.lib.WordArray.init;return initSIPEncryptor(a)}function getErrorCode(a){return"undefined"===typeof SIPHandle[a]?4098:SIPHandle[a].errorCode}function convertHelper(a,b){for(var c=[],d=0;d<b;d++)c.push(a[d>>>2]>>>24-d%4*8&255);return c}
var KEY_CODE_A=65,KEY_CODE_Z=90,KEY_CODE_SPACE=32,KEY_CODE_ENTER=13,KEY_CODE_TAB=9,KEY_CODE_ESC=27,KEY_CODE_BACKSPACE=8,KEY_CODE_SHIFT=16,KEY_CODE_CONTROL=17,KEY_CODE_ALT=18,KEY_CODE_CAPSLOCK=20,KEY_CODE_NUMLOCK=144,KEY_CODE_1=49,KEY_CODE_2=50,KEY_CODE_3=51,KEY_CODE_4=52,KEY_CODE_5=53,KEY_CODE_6=54,KEY_CODE_7=55,KEY_CODE_8=56,KEY_CODE_9=57,KEY_CODE_0=48,KEY_CODE_SEMICOLON_MOZILLA=59,KEY_CODE_SEMICOLON=186,KEY_CODE_EQUAL_MOZILLA=61,KEY_CODE_EQUAL=187,KEY_CODE_COMMA=188,KEY_CODE_MINUS_MOZILLA=173,KEY_CODE_MINUS=
189,KEY_CODE_DOT=190,KEY_CODE_DEVIDE=191,KEY_CODE_ACCENT=192,KEY_CODE_OPENING_BRACKET=219,KEY_CODE_BACKSLASH=220,KEY_CODE_CLOSING_BRACKET=221,KEY_CODE_QUOTE=222,KEY_CODE_LEFT=37,KEY_CODE_UP=38,KEY_CODE_RIGHT=39,KEY_CODE_DOWN=40,KEY_CODE_INSERT=45,KEY_CODE_DELETE=46,KEY_CODE_HOME=36,KEY_CODE_END=35,KEY_CODE_PAGEUP=33,KEY_CODE_PAGEDOWN=34,KEY_CODE_F1=112,KEY_CODE_F12=123,KEY_CODE_PAD_DOT=110,KEY_CODE_PAD_0=96,KEY_CODE_PAD_9=105,KEY_CODE_PAD_PLUS=107,KEY_CODE_PAD_MINUS=109,KEY_CODE_PAD_MUL=106,KEY_CODE_PAD_DEVIDE=
111;var DIGITAL_NUMBER=10,LETTER_NUMBER=26,UP_LOW_LETTER_ASCII_INTERVAL=32,LOW_LETTER_START_ASCII_CODE=97,LOW_LETTER_END_ASCII_CODE=123,LAST_SHOW_TIME_OUT=500;var SIPInputs={};if("undefined"===typeof SoftKeyboardSIPInputData)var SoftKeyboardSIPInputData={};
function SoftSIPInput(a,b){function c(a,b){0<navigator.userAgent.indexOf("Firefox")?a.innerHTML=b:a.innerText=b}function d(){for(var b=document.getElementById("safeKeyboard"),d=e("a","keys"),f=0,g;g=d[f],f<d.length;f++)"BS"===g.getAttribute("value")?g.onclick=function(){0!=m.value.length&&A()}:"EN"===g.getAttribute("value")?g.onclick=function(){w=!1;x();u=!0;void 0!=G._onDone&&G._onDone()}:"CL"===g.getAttribute("value")?g.onclick=function(){B=0==B?1:0;var a,b,d,e,f;if(B)for(a=2;5>a;a++)for(b=0;11>
b;b++)4==a&&3>=b||(d=document.getElementById("key"+a+b),e=d.getElementsByTagName("font")[0],f=d.getAttribute("value").charCodeAt(0),97<=f&&122>=f&&(f=String.fromCharCode(f-UP_LOW_LETTER_ASCII_INTERVAL),d.setAttribute("value",f),c(e,f)));else for(a=2;5>a;a++)for(b=0;11>b;b++)4==a&&3>=b||(d=document.getElementById("key"+a+b),e=d.getElementsByTagName("font")[0],f=d.getAttribute("value").charCodeAt(0),65<=f&&90>=f&&(f=String.fromCharCode(f+UP_LOW_LETTER_ASCII_INTERVAL),d.setAttribute("value",f),c(e,f)))}:
g.onclick=function(){var a=this.getAttribute("value");v(a)};b.onmouseover=function(){E=!1};b.onmouseout=function(){E=!0};document.onmousedown=function(){C&&E&&(w=!1,x())};if(F==SIP_TYPE_SOFT_AND_SYSTEM_KEYBOARD){var h=document.getElementById("useKey");void 0!=h&&null!=h&&(h.onclick=function(){w=!0;x();y(m.id);CFCASIPInput.lengthProperties.initialize(m.id);m.focus()},h.onmousedown=function(){h.style.backgroundColor="#6d0707"},h.onmouseup=function(){h.style.backgroundColor="#c00e12"},h.onmouseout=function(){h.style.backgroundColor=
"#c8c8c8"},h.onmouseover=function(){h.style.backgroundColor="#c00e12"});"undefined"!=typeof b.onselectstart?b.onselectstart=new Function("return false"):(b.onmousedown=new Function("return false"),b.onmouseup=new Function("return true"));m.addEventListener?(m.addEventListener("keydown",J,!1),m.addEventListener("keypress",I,!1)):(SoftKeyboardSIPInputData[a].InitedSoftKeyboard||(SoftKeyboardSIPInputData[a].InitedSoftKeyboard=!0,document.attachEvent("onkeydown",function(b){var c=document.activeElement.id;
void 0!=SIPInputs[c]&&c===a&&J(b)}),document.attachEvent("onkeypress",function(b){var c=document.activeElement.id;void 0!=SIPInputs[c]&&c===a&&I(b)})),SIPInputs[m.id]=this);document.getElementById(m.id).onfocus=function(){m=this;C||u||(clearAllCharacters(this.id),this.value="");u=!1};document.getElementById(m.id).onclick=function(){clearAllCharacters(this.id);this.value=""}}}function e(a,b){for(var c=document.getElementsByTagName(a),d=[],e=0;e<c.length;e++)-1!=c[e].className.indexOf(b)&&(d[d.length]=
c[e]);return d}function f(){for(var a=Array(DIGITAL_NUMBER),b=0;b<DIGITAL_NUMBER;b++)a[b]=String.fromCharCode(DIGITAL_NUMBER_ASCLL_FIRST+b);for(var d=0;d<DIGITAL_NUMBER;d++){var b=parseInt(10*Math.random()),e=a[0];a[0]=a[b];a[b]=e}for(b=0;b<DIGITAL_NUMBER;b++)document.getElementById("key1"+(b+1)).setAttribute("value",a[b]),c(document.getElementById("key1"+(b+1)).getElementsByTagName("font")[0],a[b])}function g(){for(var a=Array(LETTER_NUMBER),b=LOW_LETTER_START_ASCII_CODE;b<LOW_LETTER_END_ASCII_CODE;b++)a[b-
LOW_LETTER_START_ASCII_CODE]=B?String.fromCharCode(b-UP_LOW_LETTER_ASCII_INTERVAL):String.fromCharCode(b);for(var d=0;d<LETTER_NUMBER;d++){var b=parseInt(Math.random()*LETTER_NUMBER),e=a[b];a[b]=a[d];a[d]=e}b=0;for(d=2;5>d;d++)for(e=0;11>e;e++)if(!(2==d&&9<e||3==d&&8<e||4==d&&4>e)){var f=document.getElementById("key"+d+e),g=f.getElementsByTagName("font")[0],h=a[b];f.setAttribute("value",h);c(g,h);b++}}function h(){for(var a=0;a<DIGITAL_NUMBER;a++)document.getElementById("key1"+(a+1)).setAttribute("value",
""+(a+1)%DIGITAL_NUMBER),c(document.getElementById("key1"+(a+1)).getElementsByTagName("font")[0],""+(a+1)%DIGITAL_NUMBER)}function k(){for(var a="qwertyuiopasdfghjklzxcvbnm".split(""),b=0,d=2;5>d;d++)for(var e=0;11>e;e++)if(!(2==d&&9<e||3==d&&8<e||4==d&&4>e)){var f=document.getElementById("key"+d+e),g=f.getElementsByTagName("font")[0],h=a[b];f.setAttribute("value",h);c(g,h);b++}}function l(a){var b,c;if(void 0===a||null===a)return 4097;"string"===typeof a?(b=a,c=document.getElementById(b)||null):
"object"===typeof a&&(b=a.id,c=a);if(!c)return 4097;void 0==SIPHandle[a]&&initSIPHandle(b);return CFCA_OK}function x(){C=!1;document.getElementById("safeKeyboard").style.display="none";w&&(m.value="",m.readOnly=0)}function v(a){var b=document.getElementById(m.id);if(void 0!=b&&void 0!=b.value&&(0==getInnerEncryptedValueLength(m.id)&&(b.value=""),!a||0!=a.length)&&(0===b.value.length&&(y(m.id),this.sipLength=0),insertCharacter(m.id,a)==CFCA_OK)){this.sipLength+=1;for(var c="",d=0;d<this.sipLength;d++)c+=
"*";b.value=c;a=a.charCodeAt(0);48<=a&&57>=a?CFCASIPInput.lengthProperties._addDigit(m.id):65<=a&&90>=a?CFCASIPInput.lengthProperties._addUpper(m.id):97<=a&&122>=a?CFCASIPInput.lengthProperties._addLower(m.id):CFCASIPInput.lengthProperties._addSpecial(m.id)}}function A(){var a=document.getElementById(m.id);if(void 0!=a&&void 0!==a.value){CFCASIPInput.lengthProperties.initialize(this.sipHandleID);if(0>=getInnerEncryptedValueLength(m.id))return a.value="",CFCA_OK;a.value="";this.sipLength=0;return clearAllCharacters(m.id)}}
function y(a){var b=document.getElementById(a);if(void 0==b)return 4098;b.value="";this.sipLength=0;return clearAllCharacters(a)}SoftKeyboardSIPInputData[a]={InitedSoftKeyboard:!1};var m,B=0,C=!1,E=!0,w=!0,u=!1,D=0,F=b,H="~ ! @ # $ % ^ & * ( ) _ BS DF DF DF ` 1 2 3 4 5 6 7 8 9 0 - + = \\ | q w e r t y u i o p { } [ ] < > a s d f g h j k l : ; . , ' \" / CL DF DF DF z x c v b n m ? EN DF DF DF".split(" "),G=this;(function(){if(void 0==document.getElementById("safeKeyboard")){var a=document.createElement("DIV");
a.align="left";a.name="safeKeyboard";a.id="safeKeyboard";a.style.borderLeft="0px";a.style.top="0px";a.style.width="";a.style.zIndex=65535;a.style.position="absolute";a.style.display="none";a.style.backgroundColor="#c8c8c8";document.body.appendChild(a)}})();(function(){if(void 0==document.getElementById("customTableKeyboardBody")){var a=document.getElementById("safeKeyboard"),b=document.createElement("TABLE"),d=document.createElement("TBODY"),e=document.createElement("TR"),f=document.createElement("TD"),
g=document.createElement("TR"),h=document.createElement("TD"),k=document.createElement("TABLE"),l=document.createElement("TABLE");d.id="customTableKeyboardBody";e.id="customTableHeader";e.style.height="100%";f.style.border="0px";f.style.padding="0px";f.style.margin="0px";f.id="customTableHeaderTD";h.style.border="0px";h.style.padding="0px";h.style.margin="0px";b.style.borderSpacing="0px";b.style.cellSpacing="0px";l.id="tableKeys";a.appendChild(b);b.appendChild(d);d.appendChild(e);e.appendChild(f);
f.appendChild(k);d.appendChild(g);g.appendChild(h);h.appendChild(l);k.style.backgroundColor="#454549";k.style.width="100%";d=document.createElement("TBODY");a=document.createElement("TR");b=document.createElement("TD");k.appendChild(d);d.appendChild(a);a.appendChild(b);b.style.width="50%";b.id="titleText";k=document.createElement("FONT");c(k,"\u5b89\u5168\u952e\u76d8");k.style.fontWeight="bold";k.style.fontSize="15px";k.style.color="#FFFFFF";k.style.lineHeight="24px";b.appendChild(k);k=document.createElement("TD");
a.appendChild(k);a=document.createElement("INPUT");a.id="useKey";a.type="button";a.value="\u4f7f\u7528\u952e\u76d8\u8f93\u5165";a.style.width="100px";a.style.height="24px";a.style.border="1px";a.style.borderRadius="5px";a.style.fontSize="13px";a.style.lineHeight="10px";a.style.verticalAlign="middle";a.style.color="#000000";a.style.backgroundColor="#c8c8c8";a.style.padding="2px";a.style.outlineStyle="none";k.style.textAlign="right";k.appendChild(a)}})();(function(){if(void 0==document.getElementById("customTableKeys")){var a=
document.getElementById("tableKeys");a.style.cellSpacing="0px";a.style.borderSpacing="3px";a.style.border="1px";a.style.backgroundColor="#B5AFBE";a.style.marginTop="0px";var b=document.createElement("TBODY");b.id="customTableKeys";a.appendChild(b);for(a=0;5>a;a++){var d=16*a,e=document.createElement("TR");b.appendChild(e);for(var f=d;f<d+16;f++){var g=H[f],h=document.createElement("TD");h.style.padding="0px";h.height="24px";h.width="24px";var k=document.createElement("a");k.id="key"+a+f%16;k.className=
"keys";k.style.width="100%";k.style.height="100%";k.style.border="0px";k.style.padding="0px";k.style.display="inline-block";k.style.textAlign="center";k.style.backgroundColor="#1e1e1e";k.setAttribute("defaultbg","#1e1e1e");k.setAttribute("value",H[f]);k.style.cursor="default";k.style.borderRadius="2px";var l=document.createElement("FONT");l.style.width="100%";l.style.height="100%";l.style.lineHeight="24px";l.style.color="#FFFFFF";l.style.fontSize="15px";c(l,H[f]);"DF"===g&&(h.style.display="none");
"BS"===g?(h.width="",h.height="24px",h.colSpan=4,c(l,"\u9000\u683c"),l.style.lineHeight="24px"):"CL"===g?(h.width="",h.height="24px",h.colSpan=4,c(l,"\u5927\u5c0f\u5199\u5207\u6362"),l.style.lineHeight="24px"):"EN"===g&&(h.height="24px",h.width="",h.colSpan=4,c(l,"\u56de\u8f66"),l.style.lineHeight="24px");k.appendChild(l);h.appendChild(k);e.appendChild(h)}}b=document.getElementById("customTableHeader");void 0!=b&&null!=b&&(b.style.width="100%")}})();(function(){for(var a=e("a","keys"),b=0,c;c=a[b],
b<a.length;b++)c.onmouseover=function(){this.style.backgroundColor="#c00e12"},c.onmouseout=function(){this.style.backgroundColor=this.getAttribute("defaultbg")},c.onmousedown=function(){this.style.backgroundColor="#6d0707"},c.onmouseup=function(){this.style.backgroundColor="#c00e12"}})();SoftSIPInput.PREVENT_KEYS=[KEY_CODE_LEFT,KEY_CODE_RIGHT,KEY_CODE_UP,KEY_CODE_DOWN,KEY_CODE_CONTROL,KEY_CODE_INSERT,KEY_CODE_DELETE,KEY_CODE_PAGEUP,KEY_CODE_PAGEDOWN,KEY_CODE_END,KEY_CODE_HOME,KEY_CODE_ENTER];var I=
function(a){if(!C){a.preventDefault?a.preventDefault():a.returnValue=!1;var b;b=null==a.which?String.fromCharCode(a.keyCode):0!=a.which&&0!=a.charCode?String.fromCharCode(a.which):null;a=a.keyCode;null!=b&&a!=KEY_CODE_ENTER&&a!==KEY_CODE_BACKSPACE&&a!=KEY_CODE_SPACE&&" "!=b&&v(b)}},J=function(a){if(!C){var b=a.keyCode,c;a:{c=SoftSIPInput.PREVENT_KEYS;var d=0,e=c.length;if(0!==e)for(;d<e;){if(c[d]===b){c=d;break a}d++}c=-1}-1!=c?a.preventDefault?a.preventDefault():a.returnValue=!1:b===KEY_CODE_BACKSPACE&&
(a.preventDefault?a.preventDefault():a.returnValue=!1,A())}};this._show=function(a,b){D=b;m=document.getElementById(a);d(m);var c=m;void 0!=m&&(m.readOnly=0);if(void 0===SIPHandle[c.id]){l(m);var e=DEFAULT_MIN_LENGTH,p=DEFAULT_MAX_LENGTH;D=RANDOM_NONE;setMinLength(m.id,e);setMaxLength(m.id,p);setServerRandom(m.id,"MTIzNDU2Nzg5MDk4NzY1NA==");setMatchRegex(m.id,"");setInputRegex(m.id,"");setRandomType(m.id,D)}m=c;c=document.getElementById("useKey");e=document.getElementById("customTableHeader");p=document.getElementById("customTableHeaderTD");
void 0!=c&&null!=c&&void 0!=e&&null!=e&&void 0!=p&&null!=p&&(F==SIP_TYPE_SOFT_AND_SYSTEM_KEYBOARD?(e.style.display="inline-block",c.style.display="inline-block",p.style.display="block"):F==SIP_TYPE_SOFT_KEYBOARD&&(e.style.display="none",c.style.display="none",p.style.display="none"));D==RANDOM_DIGITAL?(f(),k()):D==RANDOM_DIGITAL_LETTER?(g(),f()):D==RANDOM_NONE?(h(),k()):D==RANDOM_LETTER&&(h(),g());for(var e=m.offsetTop,p=m.clientHeight,c=m.offsetLeft,n,q=m;(n=q.offsetParent)&&n!==q;)q=n,e+=n.offsetTop,
c+=n.offsetLeft;n=document.getElementById("safeKeyboard");n.style.top=e+p+5+"px";e=m.clientWidth;c+440+10>document.body.clientWidth&&(c-=440-e);n.style.left=c+"px";u=!1;m.value="";m.readOnly=1;y(m.id);CFCASIPInput.lengthProperties.initialize(m.id);m.focus();n.style.display="inline";C=!0};this._hide=function(){x()};this._bindInputBox=function(a){l(a)};this._setRandomType=function(a,b){if(void 0===a||null===a)return 4097;b==RANDOM_DIGITAL?(f(),k()):b==RANDOM_DIGITAL_LETTER?(g(),f()):b==RANDOM_NONE?
(h(),k()):b==RANDOM_LETTER&&(h(),g())}}goog.exportSymbol("SoftSIPInput",SoftSIPInput);if(document.all&&!window.setTimeout.isPolyfill){var __nativeST__=window.setTimeout;window.setTimeout=function(a,b){var c=Array.prototype.slice.call(arguments,2);return __nativeST__(a instanceof Function?function(){a.apply(null,c)}:a,b)};window.setTimeout.isPolyfill=!0}SIPInputs={};if("undefined"===typeof SystemSIPInputData)var SystemSIPInputData={};
function SystemSIPInput(a,b){SystemSIPInputData[a]={Inited:!1};var c,d;if(void 0==a||null==a)throw Error("invalid parameter");if("string"===typeof a)c=a,d=document.getElementById(c);else if("object"===typeof a)c=a.id,d=a;else throw Error("invalid parameter");if(Object.getPrototypeOf&&Object.getPrototypeOf(d)!==HTMLInputElement.prototype)throw Error("invalid parameter");d.addEventListener?(d.addEventListener("keydown",this,!1),d.addEventListener("keypress",this,!1)):(SystemSIPInputData[a].Inited||
(SystemSIPInputData[a].Inited=!0,document.attachEvent("onkeydown",function(b){var c=document.activeElement.id;void 0!=SIPInputs[c]&&c===a&&SIPInputs[c]._keyDown(b)}),document.attachEvent("onkeypress",function(b){var c=document.activeElement.id;void 0!=SIPInputs[c]&&c===a&&SIPInputs[c]._keyPress(b)})),SIPInputs[c]=this);this.sipLength=0;this.sipHandleID=c;initSIPHandle(this.sipHandleID)}goog.exportSymbol("SystemSIPInput",SystemSIPInput);
SystemSIPInput.prototype.handleEvent=function(a){switch(a.type){case "keypress":this._keyPress(a);break;case "keydown":this._keyDown(a)}};SystemSIPInput._getChar=function(a){return null==a.which?String.fromCharCode(a.keyCode):0!=a.which&&0!=a.charCode?String.fromCharCode(a.which):null};SystemSIPInput._arrayIndexOf=function(a,b){var c=0,d=a.length;if(0===d)return-1;for(;c<d;){if(a[c]===b)return c;c++}return-1};
SystemSIPInput.PREVENT_KEYS=[KEY_CODE_LEFT,KEY_CODE_RIGHT,KEY_CODE_UP,KEY_CODE_DOWN,KEY_CODE_CONTROL,KEY_CODE_INSERT,KEY_CODE_DELETE,KEY_CODE_PAGEUP,KEY_CODE_PAGEDOWN,KEY_CODE_END,KEY_CODE_HOME,KEY_CODE_ENTER];SystemSIPInput.prototype._keyPress=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;var b=SystemSIPInput._getChar(a);a=a.keyCode;null!=b&&a!=KEY_CODE_ENTER&&a!==KEY_CODE_BACKSPACE&&a!=KEY_CODE_SPACE&&" "!=b&&this._insertCharacter(b)};
SystemSIPInput.prototype._keyDown=function(a){var b=a.keyCode;-1!=SystemSIPInput._arrayIndexOf(SystemSIPInput.PREVENT_KEYS,b)?a.preventDefault?a.preventDefault():a.returnValue=!1:b===KEY_CODE_BACKSPACE&&(a.preventDefault?a.preventDefault():a.returnValue=!1,this._deleteLastCharacter())};function nCharacter(a,b){for(var c="",d=0;d<a;d++)c+=b;return c}
SystemSIPInput.prototype._insertCharacter=function(a){var b=document.getElementById(this.sipHandleID);void 0!=b&&void 0!==b.value&&(0==getInnerEncryptedValueLength(this.sipHandleID)&&(b.value=""),0===b.value.length&&(this._clearInputValue(),this.sipLength=0),a&&0==a.length||insertCharacter(this.sipHandleID,a)!=CFCA_OK||(this.sipLength+=1,b.value=nCharacter(this.sipLength,"*"),this._updateLengthProperties(a)))};
SystemSIPInput.prototype._clearInputValue=function(){var a=document.getElementById(this.sipHandleID);if(void 0==a)throw Error("invalid input element");var b=clearAllCharacters(this.sipHandleID);b==CFCA_OK&&(this.sipLength=0,a.value="");return b};
SystemSIPInput.prototype._deleteLastCharacter=function(){var a=document.getElementById(this.sipHandleID);if(void 0!=a&&void 0!=a.value){CFCASIPInput.lengthProperties.initialize(this.sipHandleID);if(0>=getInnerEncryptedValueLength(this.sipHandleID))return a.value="",CFCA_OK;a.value="";this.sipLength=0;return clearAllCharacters(this.sipHandleID)}};
SystemSIPInput.prototype._updateLengthProperties=function(a){a=a.charCodeAt(0);48<=a&&57>=a?CFCASIPInput.lengthProperties._addDigit(this.sipHandleID):65<=a&&90>=a?CFCASIPInput.lengthProperties._addUpper(this.sipHandleID):97<=a&&122>=a?CFCASIPInput.lengthProperties._addLower(this.sipHandleID):CFCASIPInput.lengthProperties._addSpecial(this.sipHandleID)};if("undefined"===typeof customSIPInput)var customSIPInput={};var sipKeyboardType=Infinity;
function CFCASIPInput(a,b){if(void 0==a||null==a)throw Error("Invalid parameter inputID");if(void 0==b||b>SIP_TYPE_SOFT_AND_SYSTEM_KEYBOARD||b<SIP_TYPE_SYSTEM_KEYBOARD)throw Error("Invalid parameter keyboardType");sipKeyboardType=b;if(b===SIP_TYPE_SYSTEM_KEYBOARD)customSIPInput[a]=new SystemSIPInput(a,b),CFCASIPInput.lengthProperties.initialize(a);else if(b===SIP_TYPE_SOFT_KEYBOARD||b===SIP_TYPE_SOFT_AND_SYSTEM_KEYBOARD)customSIPInput[a]=new SoftSIPInput(a,b),CFCASIPInput.lengthProperties.initialize(a);
else throw Error("Invalid parameter");}goog.exportSymbol("CFCASIPInput",CFCASIPInput);CFCASIPInput.prototype.bindSIPInputBox=function(a){if(void 0==a||null==a)return 4097;if(sipKeyboardType===SIP_TYPE_SOFT_AND_SYSTEM_KEYBOARD||sipKeyboardType===SIP_TYPE_SOFT_KEYBOARD){if(void 0===customSIPInput[a]||null==customSIPInput[a])return 4098;customSIPInput[a]._bindInputBox(a);return CFCA_OK}return 4105};goog.exportProperty(CFCASIPInput.prototype,"bindSIPInputBox",CFCASIPInput.prototype.bindSIPInputBox);
CFCASIPInput.prototype.showKeyboard=function(a,b){if(void 0==a||null==a)return 4097;if(sipKeyboardType===SIP_TYPE_SOFT_AND_SYSTEM_KEYBOARD||sipKeyboardType===SIP_TYPE_SOFT_KEYBOARD){if(void 0===customSIPInput[a]||null==customSIPInput[a])return 4098;customSIPInput[a]._show(a,b);return CFCA_OK}return 4105};goog.exportProperty(CFCASIPInput.prototype,"showKeyboard",CFCASIPInput.prototype.showKeyboard);
CFCASIPInput.prototype.hideKeyboard=function(a){if(void 0==a||null==a)return 4097;if(sipKeyboardType===SIP_TYPE_SOFT_AND_SYSTEM_KEYBOARD||sipKeyboardType===SIP_TYPE_SOFT_KEYBOARD){if(void 0===customSIPInput[a]||null==customSIPInput[a])return 4098;customSIPInput[a]._hide();return CFCA_OK}return 4105};goog.exportProperty(CFCASIPInput.prototype,"hideKeyboard",CFCASIPInput.prototype.hideKeyboard);CFCASIPInput.prototype.setPublicKey=function(a,b,c,d){return void 0==a||null==a?4097:setPublicKey(a,b,c,d)};
goog.exportProperty(CFCASIPInput.prototype,"setPublicKey",CFCASIPInput.prototype.setPublicKey);CFCASIPInput.prototype.setMaxLength=function(a,b){return void 0==a||null==a?4097:setMaxLength(a,b)};goog.exportProperty(CFCASIPInput.prototype,"setMaxLength",CFCASIPInput.prototype.setMaxLength);CFCASIPInput.prototype.getMaxLength=function(a){return void 0==a||null==a?4097:getMaxLength(a)};goog.exportProperty(CFCASIPInput.prototype,"getMaxLength",CFCASIPInput.prototype.getMaxLength);
CFCASIPInput.prototype.setMinLength=function(a,b){return void 0==a||null==a?4097:setMinLength(a,b)};goog.exportProperty(CFCASIPInput.prototype,"setMinLength",CFCASIPInput.prototype.setMinLength);CFCASIPInput.prototype.getMinLength=function(a){return void 0==a||null==a?4097:getMinLength(a)};goog.exportProperty(CFCASIPInput.prototype,"getMinLength",CFCASIPInput.prototype.getMinLength);CFCASIPInput.prototype.setMatchRegex=function(a,b){return void 0==a||null==a?4097:setMatchRegex(a,b)};
goog.exportProperty(CFCASIPInput.prototype,"setMatchRegex",CFCASIPInput.prototype.setMatchRegex);CFCASIPInput.prototype.getMatchRegex=function(a){return void 0==a||null==a?4097:getMatchRegex(a)};goog.exportProperty(CFCASIPInput.prototype,"getMatchRegex",CFCASIPInput.prototype.getMatchRegex);
CFCASIPInput.prototype.setRandomType=function(a,b){if(void 0==a||null==a)return 4097;if(sipKeyboardType===SIP_TYPE_SOFT_AND_SYSTEM_KEYBOARD||sipKeyboardType===SIP_TYPE_SOFT_KEYBOARD){if(void 0===customSIPInput[a]||null==customSIPInput[a])return 4098;customSIPInput[a]._setRandomType(a,b);return CFCA_OK}return 4105};goog.exportProperty(CFCASIPInput.prototype,"setRandomType",CFCASIPInput.prototype.setRandomType);
CFCASIPInput.prototype.getRandomType=function(a){return void 0==a||null==a?4097:sipKeyboardType===SIP_TYPE_SOFT_AND_SYSTEM_KEYBOARD||sipKeyboardType===SIP_TYPE_SOFT_KEYBOARD?void 0===customSIPInput[a]||null==customSIPInput[a]?4098:getRandomType(a):4105};goog.exportProperty(CFCASIPInput.prototype,"getRandomType",CFCASIPInput.prototype.getRandomType);CFCASIPInput.prototype.setServerRandom=function(a,b){return void 0==a||null==a?4097:setServerRandom(a,b)};
goog.exportProperty(CFCASIPInput.prototype,"setServerRandom",CFCASIPInput.prototype.setServerRandom);CFCASIPInput.prototype.setInputRegex=function(a,b){return void 0==a||null==a?4097:setInputRegex(a,b)};goog.exportProperty(CFCASIPInput.prototype,"setInputRegex",CFCASIPInput.prototype.setInputRegex);CFCASIPInput.prototype.getInputRegex=function(a){return void 0==a||null==a?4097:getInputRegex(a)};goog.exportProperty(CFCASIPInput.prototype,"getInputRegex",CFCASIPInput.prototype.getInputRegex);
CFCASIPInput.prototype.getEncryptedInputValue=function(a){var b=getEncryptedValue(a);if(""==b)return b;var c;a=getCipherType(a);if(4098!=a)CIPHER_TYPE_RSA==a?c="1":CIPHER_TYPE_SM2==a&&(c="0");else return"";return _getCFCAInnerVersion()+c+"@"+b};goog.exportProperty(CFCASIPInput.prototype,"getEncryptedInputValue",CFCASIPInput.prototype.getEncryptedInputValue);CFCASIPInput.prototype.getPasswordLength=function(a){return void 0==a||null==a?4097:getPasswordLength(a)};
goog.exportProperty(CFCASIPInput.prototype,"getPasswordLength",CFCASIPInput.prototype.getPasswordLength);CFCASIPInput.prototype.getLengthIntensity=function(a){return void 0==a||null==a?4097:getLengthIntensity(a)};goog.exportProperty(CFCASIPInput.prototype,"getLengthIntensity",CFCASIPInput.prototype.getLengthIntensity);CFCASIPInput.prototype.getPasswordHash=function(a){return void 0==a||null==a?4097:getPasswordHash(a)};goog.exportProperty(CFCASIPInput.prototype,"getPasswordHash",CFCASIPInput.prototype.getPasswordHash);
CFCASIPInput.prototype.checkMatchRegex=function(a,b){return void 0==a||null==a?4097:checkMatchRegex(a,b)};goog.exportProperty(CFCASIPInput.prototype,"checkMatchRegex",CFCASIPInput.prototype.checkMatchRegex);CFCASIPInput.prototype.clearInputValue=function(a){if(void 0==a||null==a)return 4097;var b=document.getElementById(a);if(void 0==b||void 0==b.value)return 4098;CFCASIPInput.lengthProperties.initialize(a);if(0>=getInnerEncryptedValueLength(a))return b.value="",CFCA_OK;b.value="";return clearAllCharacters(a)};
goog.exportProperty(CFCASIPInput.prototype,"clearInputValue",CFCASIPInput.prototype.clearInputValue);CFCASIPInput.prototype.getErrorCode=function(a){return void 0==a||null==a?4097:getErrorCode(a)};goog.exportProperty(CFCASIPInput.prototype,"getErrorCode",CFCASIPInput.prototype.getErrorCode);function getCFCASIPInputVersion(){return JAVASCRIPT_PC_SIP_VERSION}goog.exportSymbol("getCFCASIPInputVersion",getCFCASIPInputVersion);
function _getCFCAInnerVersion(){var a="0";1===VERSION_TYPE?a="0":2===VERSION_TYPE&&(a="1");return"01"+a+JAVASCRIPT_PC_SIP_VERSION.split(".").join("")}CFCASIPInput.prototype.setDoneCallback=function(a,b){if("function"===typeof b&&0===b.length){if(sipKeyboardType===SIP_TYPE_SOFT_AND_SYSTEM_KEYBOARD||sipKeyboardType===SIP_TYPE_SOFT_KEYBOARD){if(void 0===customSIPInput[a]||null==customSIPInput[a])return 4098;customSIPInput[a]._onDone=b;return CFCA_OK}return 4105}return 4106};
goog.exportProperty(CFCASIPInput.prototype,"setDoneCallback",CFCASIPInput.prototype.setDoneCallback);
CFCASIPInput.prototype.checkPasswordStrength=function(a){if(void 0==a||null==a)return 4097;var b=getMaxLength(a),c,d,e;c=new CFCASIPInput.Range(1,b);d=new CFCASIPInput.Range(1,b);e=new CFCASIPInput.Range(1,b);b=new CFCASIPInput.Range(1,b);a=CFCASIPInput.lengthProperties[a];if(void 0==a)throw Error("sipHandleID is invalid, please check whether input has bind");var f=!0,g=0;c&&(f=c.include(a.digit))&&g++;d&&(f=d.include(a.lower))&&g++;e&&(f=e.include(a.upper))&&g++;b&&(f=b.include(a.special))&&g++;
return g};goog.exportProperty(CFCASIPInput.prototype,"checkPasswordStrength",CFCASIPInput.prototype.checkPasswordStrength);CFCASIPInput.Range=function(a,b){this.N=a;this.M=b};CFCASIPInput.Range.prototype.getMin=function(){return this.N};CFCASIPInput.Range.prototype.getMax=function(){return this.M};CFCASIPInput.Range.prototype.include=function(a){return a>=this.N&&a<=this.M};CFCASIPInput.lengthProperties={};
CFCASIPInput.lengthProperties.initialize=function(a){CFCASIPInput.lengthProperties[a]={total:0,lower:0,upper:0,digit:0,special:0}};CFCASIPInput.lengthProperties._addLower=function(a){void 0!=CFCASIPInput.lengthProperties[a]&&(CFCASIPInput.lengthProperties[a].lower+=1,CFCASIPInput.lengthProperties[a].total+=1)};CFCASIPInput.lengthProperties._addUpper=function(a){void 0!=CFCASIPInput.lengthProperties[a]&&(CFCASIPInput.lengthProperties[a].upper+=1,CFCASIPInput.lengthProperties[a].total+=1)};
CFCASIPInput.lengthProperties._addDigit=function(a){void 0!=CFCASIPInput.lengthProperties[a]&&(CFCASIPInput.lengthProperties[a].digit+=1,CFCASIPInput.lengthProperties[a].total+=1)};CFCASIPInput.lengthProperties._addSpecial=function(a){void 0!=CFCASIPInput.lengthProperties[a]&&(CFCASIPInput.lengthProperties[a].special+=1,CFCASIPInput.lengthProperties[a].total+=1)};CFCASIPInput.lengthProperties._clear=function(a){void 0!=CFCASIPInput.lengthProperties[a]&&CFCASIPInput.lengthProperties.initialize(a)};
CFCASIPInput.prototype.checkPasswordStrengthWithRange=function(a,b,c,d,e,f){a=a||this.sipHandleID;if(void 0==a)throw Error("sipHandleID is invalid");a=CFCASIPInput.lengthProperties[a];if(void 0==a)throw Error("sipHandleID is invalid, please check whether input has bind");var g=!0;b&&(g=g&&b.include(a.total));c&&(g=g&&c.include(a.digit));d&&(g=g&&d.include(a.lower));e&&(g=g&&e.include(a.upper));f&&(g=g&&f.include(a.special));return g};function ECFieldElementFp(a,b){this.x=b;this.q=a}
function feFpEquals(a){return a==this?!0:this.q.equals(a.q)&&this.x.equals(a.x)}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(a){return new ECFieldElementFp(this.q,this.x.add(a.toBigInteger()).mod(this.q))}function feFpSubtract(a){return new ECFieldElementFp(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))}
function feFpMultiply(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))}ECFieldElementFp.prototype.equals=feFpEquals;ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger;ECFieldElementFp.prototype.negate=feFpNegate;ECFieldElementFp.prototype.add=feFpAdd;
ECFieldElementFp.prototype.subtract=feFpSubtract;ECFieldElementFp.prototype.multiply=feFpMultiply;ECFieldElementFp.prototype.square=feFpSquare;ECFieldElementFp.prototype.divide=feFpDivide;function ECPointFp(a,b,c,d){this.curve=a;this.x=b;this.y=c;this.z=null==d?BigInteger.ONE:d;this.zinv=null}function pointFpGetX(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var a=this.x.toBigInteger().multiply(this.zinv);this.curve.reduce(a);return this.curve.fromBigInteger(a)}
function pointFpGetY(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var a=this.y.toBigInteger().multiply(this.zinv);this.curve.reduce(a);return this.curve.fromBigInteger(a)}
function pointFpEquals(a){return a==this?!0:this.isInfinity()?a.isInfinity():a.isInfinity()?this.isInfinity():a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(BigInteger.ZERO)?a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(BigInteger.ZERO):!1}
function pointFpIsInfinity(){return null==this.x&&null==this.y?!0:this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}
function pointFpAdd(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var b=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),c=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(c))return BigInteger.ZERO.equals(b)?this.twice():this.curve.getInfinity();var d=new BigInteger("3"),e=this.x.toBigInteger(),f=this.y.toBigInteger();a.x.toBigInteger();a.y.toBigInteger();
var g=c.square(),h=g.multiply(c),e=e.multiply(g),g=b.square().multiply(this.z),c=g.subtract(e.shiftLeft(1)).multiply(a.z).subtract(h).multiply(c).mod(this.curve.q),b=e.multiply(d).multiply(b).subtract(f.multiply(h)).subtract(g.multiply(b)).multiply(a.z).add(b.multiply(h)).mod(this.curve.q);a=h.multiply(this.z).multiply(a.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(c),this.curve.fromBigInteger(b),a)}
function pointFpTwice(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var a=new BigInteger("3"),b=this.x.toBigInteger(),c=this.y.toBigInteger(),d=c.multiply(this.z),e=d.multiply(c).mod(this.curve.q),c=this.curve.a.toBigInteger(),f=b.square().multiply(a);BigInteger.ZERO.equals(c)||(f=f.add(this.z.square().multiply(c)));f=f.mod(this.curve.q);c=f.square().subtract(b.shiftLeft(3).multiply(e)).shiftLeft(1).multiply(d).mod(this.curve.q);a=f.multiply(a).multiply(b).subtract(e.shiftLeft(1)).shiftLeft(2).multiply(e).subtract(f.square().multiply(f)).mod(this.curve.q);
d=d.square().multiply(d).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(c),this.curve.fromBigInteger(a),d)}function pointFpMultiply(a){if(this.isInfinity())return this;if(0==a.signum())return this.curve.getInfinity();var b=a.multiply(new BigInteger("3")),c=this.negate(),d=this,e;for(e=b.bitLength()-2;0<e;--e){var d=d.twice(),f=b.testBit(e),g=a.testBit(e);f!=g&&(d=d.add(f?this:c))}return d}
function pointFpMultiplyTwo(a,b,c){var d;d=a.bitLength()>c.bitLength()?a.bitLength()-1:c.bitLength()-1;for(var e=this.curve.getInfinity(),f=this.add(b);0<=d;)e=e.twice(),a.testBit(d)?e=c.testBit(d)?e.add(f):e.add(this):c.testBit(d)&&(e=e.add(b)),--d;return e}ECPointFp.prototype.getX=pointFpGetX;ECPointFp.prototype.getY=pointFpGetY;ECPointFp.prototype.equals=pointFpEquals;ECPointFp.prototype.isInfinity=pointFpIsInfinity;ECPointFp.prototype.negate=pointFpNegate;ECPointFp.prototype.add=pointFpAdd;
ECPointFp.prototype.twice=pointFpTwice;ECPointFp.prototype.multiply=pointFpMultiply;ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo;function ECCurveFp(a,b,c){this.q=a;this.a=this.fromBigInteger(b);this.b=this.fromBigInteger(c);this.infinity=new ECPointFp(this,null,null);this.reducer=new Barrett(this.q)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}
function curveFpEquals(a){return a==this?!0:this.q.equals(a.q)&&this.a.equals(a.a)&&this.b.equals(a.b)}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(a){return new ECFieldElementFp(this.q,a)}function curveReduce(a){this.reducer.reduce(a)}
function curveFpDecodePointHex(a){switch(parseInt(a.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var b=(a.length-2)/2,c=a.substr(2,b);a=a.substr(b+2,b);return new ECPointFp(this,this.fromBigInteger(new BigInteger(c,16)),this.fromBigInteger(new BigInteger(a,16)));default:return null}}
function curveFpEncodePointHex(a){if(a.isInfinity())return"00";var b=a.getX().toBigInteger().toString(16);a=a.getY().toBigInteger().toString(16);var c=this.getQ().toString(16).length;for(0!=c%2&&c++;b.length<c;)b="0"+b;for(;a.length<c;)a="0"+a;return"04"+b+a}ECCurveFp.prototype.getQ=curveFpGetQ;ECCurveFp.prototype.getA=curveFpGetA;ECCurveFp.prototype.getB=curveFpGetB;ECCurveFp.prototype.equals=curveFpEquals;ECCurveFp.prototype.getInfinity=curveFpGetInfinity;ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger;
ECCurveFp.prototype.reduce=curveReduce;ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex;ECCurveFp.prototype.encodePointHex=curveFpEncodePointHex;var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(canary&16777215);function BigInteger(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function nbi(){return new BigInteger(null)}
function am1(a,b,c,d,e,f){for(;0<=--f;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864);c[d++]=g&67108863}return e}function am2(a,b,c,d,e,f){var g=b&32767;for(b>>=15;0<=--f;){var h=this[a]&32767,k=this[a++]>>15,l=b*h+k*g,h=g*h+((l&32767)<<15)+c[d]+(e&1073741823);e=(h>>>30)+(l>>>15)+b*k+(e>>>30);c[d++]=h&1073741823}return e}
function am3(a,b,c,d,e,f){var g=b&16383;for(b>>=14;0<=--f;){var h=this[a]&16383,k=this[a++]>>14,l=b*h+k*g,h=g*h+((l&16383)<<14)+c[d]+e;e=(h>>28)+(l>>14)+b*k;c[d++]=h&268435455}return e}j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28);BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=(1<<dbits)-1;BigInteger.prototype.DV=1<<dbits;
var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=[],rr,vv;rr=48;for(vv=0;9>=vv;++vv)BI_RC[rr++]=vv;rr=97;for(vv=10;36>vv;++vv)BI_RC[rr++]=vv;rr=65;for(vv=10;36>vv;++vv)BI_RC[rr++]=vv;function int2char(a){return BI_RM.charAt(a)}function intAt(a,b){var c=BI_RC[a.charCodeAt(b)];return null==c?-1:c}
function bnpCopyTo(a){for(var b=this.t-1;0<=b;--b)a[b]=this[b];a.t=this.t;a.s=this.s}function bnpFromInt(a){this.t=1;this.s=0>a?-1:0;0<a?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0}function nbv(a){var b=nbi();b.fromInt(a);return b}
function bnpFromString(a,b){var c;if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else if(4==b)c=2;else{this.fromRadix(a,b);return}this.s=this.t=0;for(var d=a.length,e=!1,f=0;0<=--d;){var g=8==c?a[d]&255:intAt(a,d);0>g?"-"==a.charAt(d)&&(e=!0):(e=!1,0==f?this[this.t++]=g:f+c>this.DB?(this[this.t-1]|=(g&(1<<this.DB-f)-1)<<f,this[this.t++]=g>>this.DB-f):this[this.t-1]|=g<<f,f+=c,f>=this.DB&&(f-=this.DB))}8==c&&0!=(a[0]&128)&&(this.s=-1,0<f&&(this[this.t-1]|=(1<<this.DB-
f)-1<<f));this.clamp();e&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var a=this.s&this.DM;0<this.t&&this[this.t-1]==a;)--this.t}
function bnToString(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==a)a=5;else if(4==a)a=2;else return this.toRadix(a);var b=(1<<a)-1,c,d=!1,e="",f=this.t,g=this.DB-f*this.DB%a;if(0<f--)for(g<this.DB&&0<(c=this[f]>>g)&&(d=!0,e=int2char(c));0<=f;)g<a?(c=(this[f]&(1<<g)-1)<<a-g,c|=this[--f]>>(g+=this.DB-a)):(c=this[f]>>(g-=a)&b,0>=g&&(g+=this.DB,--f)),0<c&&(d=!0),d&&(e+=int2char(c));return d?e:"0"}
function bnNegate(){var a=nbi();BigInteger.ZERO.subTo(this,a);return a}function bnAbs(){return 0>this.s?this.negate():this}function bnCompareTo(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t,b=c-a.t;if(0!=b)return 0>this.s?-b:b;for(;0<=--c;)if(0!=(b=this[c]-a[c]))return b;return 0}function nbits(a){var b=1,c;0!=(c=a>>>16)&&(a=c,b+=16);0!=(c=a>>8)&&(a=c,b+=8);0!=(c=a>>4)&&(a=c,b+=4);0!=(c=a>>2)&&(a=c,b+=2);0!=a>>1&&(b+=1);return b}
function bnBitLength(){return 0>=this.t?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(a,b){var c;for(c=this.t-1;0<=c;--c)b[c+a]=this[c];for(c=a-1;0<=c;--c)b[c]=0;b.t=this.t+a;b.s=this.s}function bnpDRShiftTo(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0);b.s=this.s}
function bnpLShiftTo(a,b){var c=a%this.DB,d=this.DB-c,e=(1<<d)-1,f=Math.floor(a/this.DB),g=this.s<<c&this.DM,h;for(h=this.t-1;0<=h;--h)b[h+f+1]=this[h]>>d|g,g=(this[h]&e)<<c;for(h=f-1;0<=h;--h)b[h]=0;b[f]=g;b.t=this.t+f+1;b.s=this.s;b.clamp()}
function bnpRShiftTo(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)b.t=0;else{var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;0<d&&(b[this.t-c-1]|=(this.s&f)<<e);b.t=this.t-c;b.clamp()}}
function bnpSubTo(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0;-1>d?b[c++]=this.DV+d:0<d&&(b[c++]=d);b.t=c;b.clamp()}
function bnpMultiplyTo(a,b){var c=this.abs(),d=a.abs(),e=c.t;for(b.t=e+d.t;0<=--e;)b[e]=0;for(e=0;e<d.t;++e)b[e+c.t]=c.am(0,d[e],b,e,0,c.t);b.s=0;b.clamp();this.s!=a.s&&BigInteger.ZERO.subTo(b,b)}function bnpSquareTo(a){for(var b=this.abs(),c=a.t=2*b.t;0<=--c;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}0<a.t&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1));a.s=0;a.clamp()}
function bnpDivRemTo(a,b,c){var d=a.abs();if(!(0>=d.t)){var e=this.abs();if(e.t<d.t)null!=b&&b.fromInt(0),null!=c&&this.copyTo(c);else{null==c&&(c=nbi());var f=nbi(),g=this.s;a=a.s;var h=this.DB-nbits(d[d.t-1]);0<h?(d.lShiftTo(h,f),e.lShiftTo(h,c)):(d.copyTo(f),e.copyTo(c));d=f.t;e=f[d-1];if(0!=e){var k=e*(1<<this.F1)+(1<d?f[d-2]>>this.F2:0),l=this.FV/k,k=(1<<this.F1)/k,x=1<<this.F2,v=c.t,A=v-d,y=null==b?nbi():b;f.dlShiftTo(A,y);0<=c.compareTo(y)&&(c[c.t++]=1,c.subTo(y,c));BigInteger.ONE.dlShiftTo(d,
y);for(y.subTo(f,f);f.t<d;)f[f.t++]=0;for(;0<=--A;){var m=c[--v]==e?this.DM:Math.floor(c[v]*l+(c[v-1]+x)*k);if((c[v]+=f.am(0,m,c,A,0,d))<m)for(f.dlShiftTo(A,y),c.subTo(y,c);c[v]<--m;)c.subTo(y,c)}null!=b&&(c.drShiftTo(d,b),g!=a&&BigInteger.ZERO.subTo(b,b));c.t=d;c.clamp();0<h&&c.rShiftTo(h,c);0>g&&BigInteger.ZERO.subTo(c,c)}}}}function bnMod(a){var b=nbi();this.abs().divRemTo(a,null,b);0>this.s&&0<b.compareTo(BigInteger.ZERO)&&a.subTo(b,b);return b}function Classic(a){this.m=a}
function cConvert(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(a,b,c){a.multiplyTo(b,c);this.reduce(c)}function cSqrTo(a,b){a.squareTo(b);this.reduce(b)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;
function bnpInvDigit(){if(1>this.t)return 0;var a=this[0];if(0==(a&1))return 0;var b=a&3,b=b*(2-(a&15)*b)&15,b=b*(2-(a&255)*b)&255,b=b*(2-((a&65535)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV;return 0<b?this.DV-b:-b}function Montgomery(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}
function montConvert(a){var b=nbi();a.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);0>a.s&&0<b.compareTo(BigInteger.ZERO)&&this.m.subTo(b,b);return b}function montRevert(a){var b=nbi();a.copyTo(b);this.reduce(b);return b}
function montReduce(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=a[b]&32767,d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM,c=b+this.m.t;for(a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp();a.drShiftTo(this.m.t,a);0<=a.compareTo(this.m)&&a.subTo(this.m,a)}function montSqrTo(a,b){a.squareTo(b);this.reduce(b)}function montMulTo(a,b,c){a.multiplyTo(b,c);this.reduce(c)}Montgomery.prototype.convert=montConvert;
Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return 0==(0<this.t?this[0]&1:this.s)}function bnpExp(a,b){if(4294967295<a||1>a)return BigInteger.ONE;var c=nbi(),d=nbi(),e=b.convert(this),f=nbits(a)-1;for(e.copyTo(c);0<=--f;)if(b.sqrTo(c,d),0<(a&1<<f))b.mulTo(d,e,c);else var g=c,c=d,d=g;return b.revert(c)}
function bnModPowInt(a,b){var c;c=256>a||b.isEven()?new Classic(b):new Montgomery(b);return this.exp(a,c)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;
BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;
BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var a=nbi();this.copyTo(a);return a}function bnIntValue(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}
function bnSigNum(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1}function bnpToRadix(a){null==a&&(a=10);if(0==this.signum()||2>a||36<a)return"0";var b=this.chunkSize(a),b=Math.pow(a,b),c=nbv(b),d=nbi(),e=nbi(),f="";for(this.divRemTo(c,d,e);0<d.signum();)f=(b+e.intValue()).toString(a).substr(1)+f,d.divRemTo(c,d,e);return e.intValue().toString(a)+f}
function bnpFromRadix(a,b){this.fromInt(0);null==b&&(b=10);for(var c=this.chunkSize(b),d=Math.pow(b,c),e=!1,f=0,g=0,h=0;h<a.length;++h){var k=intAt(a,h);0>k?"-"==a.charAt(h)&&0==this.signum()&&(e=!0):(g=b*g+k,++f>=c&&(this.dMultiply(d),this.dAddOffset(g,0),g=f=0))}0<f&&(this.dMultiply(Math.pow(b,f)),this.dAddOffset(g,0));e&&BigInteger.ZERO.subTo(this,this)}
function bnpFromNumber(a,b,c){if("number"==typeof b)if(2>a)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(BigInteger.ONE.shiftLeft(a-1),this);else{c=[];var d=a&7;c.length=(a>>3)+1;b.nextBytes(c);c[0]=0<d?c[0]&(1<<d)-1:0;this.fromString(c,256)}}
function bnToByteArray(){var a=this.t,b=[];b[0]=this.s;var c=this.DB-a*this.DB%8,d,e=0;if(0<a--)for(c<this.DB&&(d=this[a]>>c)!=(this.s&this.DM)>>c&&(b[e++]=d|this.s<<this.DB-c);0<=a;)if(8>c?(d=(this[a]&(1<<c)-1)<<8-c,d|=this[--a]>>(c+=this.DB-8)):(d=this[a]>>(c-=8)&255,0>=c&&(c+=this.DB,--a)),0!=(d&128)&&(d|=-256),0==e&&(this.s&128)!=(d&128)&&++e,0<e||d!=this.s)b[e++]=d;return b}function bnEquals(a){return 0==this.compareTo(a)}function bnMin(a){return 0>this.compareTo(a)?this:a}
function bnMax(a){return 0<this.compareTo(a)?this:a}function bnpBitwiseTo(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;d<f;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){e=a.s&this.DM;for(d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{e=this.s&this.DM;for(d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s);c.clamp()}function op_and(a,b){return a&b}function bnAnd(a){var b=nbi();this.bitwiseTo(a,op_and,b);return b}function op_or(a,b){return a|b}
function bnOr(a){var b=nbi();this.bitwiseTo(a,op_or,b);return b}function op_xor(a,b){return a^b}function bnXor(a){var b=nbi();this.bitwiseTo(a,op_xor,b);return b}function op_andnot(a,b){return a&~b}function bnAndNot(a){var b=nbi();this.bitwiseTo(a,op_andnot,b);return b}function bnNot(){for(var a=nbi(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];a.t=this.t;a.s=~this.s;return a}function bnShiftLeft(a){var b=nbi();0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b);return b}
function bnShiftRight(a){var b=nbi();0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b);return b}function lbit(a){if(0==a)return-1;var b=0;0==(a&65535)&&(a>>=16,b+=16);0==(a&255)&&(a>>=8,b+=8);0==(a&15)&&(a>>=4,b+=4);0==(a&3)&&(a>>=2,b+=2);0==(a&1)&&++b;return b}function bnGetLowestSetBit(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+lbit(this[a]);return 0>this.s?this.t*this.DB:-1}function cbit(a){for(var b=0;0!=a;)a&=a-1,++b;return b}
function bnBitCount(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=cbit(this[c]^b);return a}function bnTestBit(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)}function bnpChangeBit(a,b){var c=BigInteger.ONE.shiftLeft(a);this.bitwiseTo(c,b,c);return c}function bnSetBit(a){return this.changeBit(a,op_or)}function bnClearBit(a){return this.changeBit(a,op_andnot)}function bnFlipBit(a){return this.changeBit(a,op_xor)}
function bnpAddTo(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0;0<d?b[c++]=d:-1>d&&(b[c++]=this.DV+d);b.t=c;b.clamp()}function bnAdd(a){var b=nbi();this.addTo(a,b);return b}function bnSubtract(a){var b=nbi();this.subTo(a,b);return b}
function bnMultiply(a){var b=nbi();this.multiplyTo(a,b);return b}function bnSquare(){var a=nbi();this.squareTo(a);return a}function bnDivide(a){var b=nbi();this.divRemTo(a,b,null);return b}function bnRemainder(a){var b=nbi();this.divRemTo(a,null,b);return b}function bnDivideAndRemainder(a){var b=nbi(),c=nbi();this.divRemTo(a,b,c);return[b,c]}function bnpDMultiply(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()}
function bnpDAddOffset(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}}function NullExp(){}function nNop(a){return a}function nMulTo(a,b,c){a.multiplyTo(b,c)}function nSqrTo(a,b){a.squareTo(b)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(a){return this.exp(a,new NullExp)}
function bnpMultiplyLowerTo(a,b,c){var d=Math.min(this.t+a.t,b);c.s=0;for(c.t=d;0<d;)c[--d]=0;var e;for(e=c.t-this.t;d<e;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);d<e;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()}function bnpMultiplyUpperTo(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;0<=--d;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp();c.drShiftTo(1,c)}
function Barrett(a){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);this.m=a}function barrettConvert(a){if(0>a.s||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var b=nbi();a.copyTo(b);this.reduce(b);return b}function barrettRevert(a){return a}
function barrettReduce(a){a.drShiftTo(this.m.t-1,this.r2);a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);0<=a.compareTo(this.m);)a.subTo(this.m,a)}function barrettSqrTo(a,b){a.squareTo(b);this.reduce(b)}function barrettMulTo(a,b,c){a.multiplyTo(b,c);this.reduce(c)}Barrett.prototype.convert=barrettConvert;
Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;
function bnModPow(a,b){var c=a.bitLength(),d,e=nbv(1),f;if(0>=c)return e;d=18>c?1:48>c?3:144>c?4:768>c?5:6;f=8>c?new Classic(b):b.isEven()?new Barrett(b):new Montgomery(b);var g=[],h=3,k=d-1,l=(1<<d)-1;g[1]=f.convert(this);if(1<d)for(c=nbi(),f.sqrTo(g[1],c);h<=l;)g[h]=nbi(),f.mulTo(c,g[h-2],g[h]),h+=2;for(var x=a.t-1,v,A=!0,y=nbi(),c=nbits(a[x])-1;0<=x;){c>=k?v=a[x]>>c-k&l:(v=(a[x]&(1<<c+1)-1)<<k-c,0<x&&(v|=a[x-1]>>this.DB+c-k));for(h=d;0==(v&1);)v>>=1,--h;0>(c-=h)&&(c+=this.DB,--x);if(A)g[v].copyTo(e),
A=!1;else{for(;1<h;)f.sqrTo(e,y),f.sqrTo(y,e),h-=2;0<h?f.sqrTo(e,y):(h=e,e=y,y=h);f.mulTo(y,g[v],e)}for(;0<=x&&0==(a[x]&1<<c);)f.sqrTo(e,y),h=e,e=y,y=h,0>--c&&(c=this.DB-1,--x)}return f.revert(e)}
function bnGCD(a){var b=0>this.s?this.negate():this.clone();a=0>a.s?a.negate():a.clone();if(0>b.compareTo(a)){var c=b,b=a;a=c}var c=b.getLowestSetBit(),d=a.getLowestSetBit();if(0>d)return b;c<d&&(d=c);0<d&&(b.rShiftTo(d,b),a.rShiftTo(d,a));for(;0<b.signum();)0<(c=b.getLowestSetBit())&&b.rShiftTo(c,b),0<(c=a.getLowestSetBit())&&a.rShiftTo(c,a),0<=b.compareTo(a)?(b.subTo(a,b),b.rShiftTo(1,b)):(a.subTo(b,a),a.rShiftTo(1,a));0<d&&a.lShiftTo(d,a);return a}
function bnpModInt(a){if(0>=a)return 0;var b=this.DV%a,c=0>this.s?a-1:0;if(0<this.t)if(0==b)c=this[0]%a;else for(var d=this.t-1;0<=d;--d)c=(b*c+this[d])%a;return c}
function bnModInverse(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return BigInteger.ZERO;for(var c=a.clone(),d=this.clone(),e=nbv(1),f=nbv(0),g=nbv(0),h=nbv(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),b?(e.isEven()&&f.isEven()||(e.addTo(this,e),f.subTo(a,f)),e.rShiftTo(1,e)):f.isEven()||f.subTo(a,f),f.rShiftTo(1,f);for(;d.isEven();)d.rShiftTo(1,d),b?(g.isEven()&&h.isEven()||(g.addTo(this,g),h.subTo(a,h)),g.rShiftTo(1,g)):h.isEven()||h.subTo(a,h),h.rShiftTo(1,h);0<=c.compareTo(d)?
(c.subTo(d,c),b&&e.subTo(g,e),f.subTo(h,f)):(d.subTo(c,d),b&&g.subTo(e,g),h.subTo(f,h))}if(0!=d.compareTo(BigInteger.ONE))return BigInteger.ZERO;if(0<=h.compareTo(a))return h.subtract(a);if(0>h.signum())h.addTo(a,h);else return h;return 0>h.signum()?h.add(a):h}
var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,
733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=67108864/lowprimes[lowprimes.length-1];
function bnIsProbablePrime(a){var b,c=this.abs();if(1==c.t&&c[0]<=lowprimes[lowprimes.length-1]){for(b=0;b<lowprimes.length;++b)if(c[0]==lowprimes[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<lowprimes.length;){for(var d=lowprimes[b],e=b+1;e<lowprimes.length&&d<lplim;)d*=lowprimes[e++];for(d=c.modInt(d);b<e;)if(0==d%lowprimes[b++])return!1}return c.millerRabin(a)}
function bnpMillerRabin(a){var b=this.subtract(BigInteger.ONE),c=b.getLowestSetBit();if(0>=c)return!1;var d=b.shiftRight(c);a=a+1>>1;a>lowprimes.length&&(a=lowprimes.length);for(var e=nbi(),f=0;f<a;++f){e.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var g=e.modPow(d,this);if(0!=g.compareTo(BigInteger.ONE)&&0!=g.compareTo(b)){for(var h=1;h++<c&&0!=g.compareTo(b);)if(g=g.modPowInt(2,this),0==g.compareTo(BigInteger.ONE))return!1;if(0!=g.compareTo(b))return!1}}return!0}
BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;
BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;
BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;
BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;function Arcfour(){this.j=this.i=0;this.S=[]}
function ARC4init(a){var b,c,d;for(b=0;256>b;++b)this.S[b]=b;for(b=c=0;256>b;++b)c=c+this.S[b]+a[b%a.length]&255,d=this.S[b],this.S[b]=this.S[c],this.S[c]=d;this.j=this.i=0}function ARC4next(){var a;this.i=this.i+1&255;this.j=this.j+this.S[this.i]&255;a=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=a;return this.S[a+this.S[this.i]&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour}var rng_psize=256;var VERSION_TYPE=1;
if(1==VERSION_TYPE)var RSA_VERIFY_PUBLICKEY_TEST="MIGIAoGAqxARRHZtYTLYxG2TZt/lXH1NOvXLlR6rVg6qEbUzQLT0Zu/PKZYyMwrCnC/JuLhFwR79PozJJLaAMJyMLc2MOJjxyO79cYxGzuZ1JhdXu53PaUOJwX4SRHmqY9VG1ZgiS27TMeo87fL79IqhA9YzJCo60Zmh52JZcWjvIHDOYDECAwEAAQ==",RSA_VERIFY_PUBLICKEY_PRODUCT="MIGIAoGA2HC+wRPOyBGjrWY8EjJ/hgY5QSqAX3XoOjr6IzfUMmOXh9uTDvC5WHYt6kuTVl3EN9Nk0xG6ZhuL93gm5qvqGfOcJAanzKiE3000pztk/iKM9Un9rGNoRCf6lYEZteMFQ65Iaw+0fPwuOLZIf9Dood0xSqhIicVvW1POyGujQ48CAwEAAQ==";else 2==VERSION_TYPE&&(RSA_VERIFY_PUBLICKEY_PRODUCT=
RSA_VERIFY_PUBLICKEY_TEST="MIGJAoGBAMCq8fokiWzJVq5MsqEiQhXWpskewxLmcM5CKvubzzWKTPF0H5vNbJwzfvJNlmFvaKujURvPqLwJ82uVzfBm74CMa8wKIUkpu9Q4LkymUMnRxHeV5IIFFOmDyPkm/Agk929AMwVAwl69cQN4A2FR9QCsrh2r67b49i9ADzeuS5+3AgMBAAE=");var rng_state,rng_pool,rng_pptr;function rng_seed_int(a){rng_pool[rng_pptr++]^=a&255;rng_pool[rng_pptr++]^=a>>8&255;rng_pool[rng_pptr++]^=a>>16&255;rng_pool[rng_pptr++]^=a>>24&255;rng_pptr>=rng_psize&&(rng_pptr-=rng_psize)}
function rng_seed_time(){rng_seed_int((new Date).getTime())}
if(null==rng_pool){rng_pool=[];rng_pptr=0;var t;if(window.crypto&&window.crypto.getRandomValues){var ua=new Uint8Array(32);window.crypto.getRandomValues(ua);for(t=0;32>t;++t)rng_pool[rng_pptr++]=ua[t]}if("Netscape"==navigator.appName&&"5">navigator.appVersion&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=z.charCodeAt(t)&255}for(;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=t&255;rng_pptr=0;rng_seed_time()}
function rng_get_byte(){if(null==rng_state){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(a){var b;for(b=0;b<a.length;++b)a[b]=rng_get_byte()}function rng_get_bytes_without0(a,b,c){for(var d=0;d<c;++d){var e=rng_get_byte();0==e&&(e=rng_get_byte()+1);a[b+d]=e}}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;
function parseBigInt(a,b){return new BigInteger(a,b)}function linebrk(a,b){for(var c="",d=0;d+b<a.length;)c+=a.substring(d,d+b)+"\n",d+=b;return c+a.substring(d,a.length)}function byte2Hex(a){return 16>a?"0"+a.toString(16):a.toString(16)}
function pkcs1pad2(a,b){if(b<a.length+11)throw Error("Message too long for RSA");for(var c=[],d=a.length-1;0<=d&&0<b;){var e=a.charCodeAt(d--);128>e?c[--b]=e:127<e&&2048>e?(c[--b]=e&63|128,c[--b]=e>>6|192):(c[--b]=e&63|128,c[--b]=e>>6&63|128,c[--b]=e>>12|224)}c[--b]=0;d=new SecureRandom;for(e=[];2<b;){for(e[0]=0;0==e[0];)d.nextBytes(e);c[--b]=e[0]}c[--b]=2;c[--b]=0;return new BigInteger(c)}function RSAKey(){this.n=null;this.e=0;this.coeff=this.dmq1=this.dmp1=this.q=this.p=this.d=null}
function RSASetPublic(a,b){if(null!=a&&null!=b&&0<a.length&&0<b.length)this.n=parseBigInt(a,16),this.e=parseInt(b,16);else throw Error("Invalid RSA public key");}function RSADoPublic(a){return a.modPowInt(this.e,this.n)}function RSAEncrypt(a){a=pkcs1pad2(a,this.n.bitLength()+7>>3);if(null==a)return null;a=this.doPublic(a);if(null==a)return null;a=a.toString(16);return 0==(a.length&1)?a:"0"+a}
function RSAEncryptForArrayInner(a){var b=this.n.bitLength()+7>>3;if(b<a.length+11)throw Error("Message too long for RSA");for(var c=[],d=a.length-1;0<=d&&0<b;)c[--b]=a[d--];c[--b]=0;a=new SecureRandom;for(d=[];2<b;){for(d[0]=0;0==d[0];)a.nextBytes(d);c[--b]=d[0]}c[--b]=2;c[--b]=0;b=this.doPublic(new BigInteger(c));if(null==b)return null;b=b.toString(16);return 0==(b.length&1)?b:"0"+b}
function RSAEncryptForArrayNoPadding(a){if(this.n.bitLength()+7>>3!=a.length)throw Error("Message length must equal to RSA key bit length");a=this.doPublic(new BigInteger(a));if(null==a)return null;a=a.toString(16);return 0==(a.length&1)?a:"0"+a}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;RSAKey.prototype.encryptForArray=RSAEncryptForArrayInner;RSAKey.prototype.encryptForArrayNoPadding=RSAEncryptForArrayNoPadding;
function pkcs1unpad2(a,b){for(var c=a.toByteArray(),d=0;d<c.length&&0==c[d];)++d;if(c.length-d!=b-1||2!=c[d])return null;for(++d;0!=c[d];)if(++d>=c.length)return null;for(var e="";++d<c.length;){var f=c[d]&255;128>f?e+=String.fromCharCode(f):191<f&&224>f?(e+=String.fromCharCode((f&31)<<6|c[d+1]&63),++d):(e+=String.fromCharCode((f&15)<<12|(c[d+1]&63)<<6|c[d+2]&63),d+=2)}return e}
function RSASetPrivate(a,b,c){if(null!=a&&null!=b&&0<a.length&&0<b.length)this.n=parseBigInt(a,16),this.e=parseInt(b,16),this.d=parseBigInt(c,16);else throw Error("Invalid RSA private key");}
function RSASetPrivateEx(a,b,c,d,e,f,g,h){if(null!=a&&null!=b&&0<a.length&&0<b.length)this.n=parseBigInt(a,16),this.e=parseInt(b,16),this.d=parseBigInt(c,16),this.p=parseBigInt(d,16),this.q=parseBigInt(e,16),this.dmp1=parseBigInt(f,16),this.dmq1=parseBigInt(g,16),this.coeff=parseBigInt(h,16);else throw Error("Invalid RSA private key");}
function RSAGenerate(a,b){var c=new SecureRandom,d=a>>1;this.e=parseInt(b,16);for(var e=new BigInteger(b,16);;){for(;this.p=new BigInteger(a-d,1,c),0!=this.p.subtract(BigInteger.ONE).gcd(e).compareTo(BigInteger.ONE)||!this.p.isProbablePrime(10););for(;this.q=new BigInteger(d,1,c),0!=this.q.subtract(BigInteger.ONE).gcd(e).compareTo(BigInteger.ONE)||!this.q.isProbablePrime(10););if(0>=this.p.compareTo(this.q)){var f=this.p;this.p=this.q;this.q=f}var f=this.p.subtract(BigInteger.ONE),g=this.q.subtract(BigInteger.ONE),
h=f.multiply(g);if(0==h.gcd(e).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q);this.d=e.modInverse(h);this.dmp1=this.d.mod(f);this.dmq1=this.d.mod(g);this.coeff=this.q.modInverse(this.p);break}}}function RSADoPrivate(a){if(null==this.p||null==this.q)return a.modPow(this.d,this.n);var b=a.mod(this.p).modPow(this.dmp1,this.p);for(a=a.mod(this.q).modPow(this.dmq1,this.q);0>b.compareTo(a);)b=b.add(this.p);return b.subtract(a).multiply(this.coeff).mod(this.p).multiply(this.q).add(a)}
function RSADecrypt(a){a=parseBigInt(a,16);a=this.doPrivate(a);return null==a?null:pkcs1unpad2(a,this.n.bitLength()+7>>3)}RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.generate=RSAGenerate;RSAKey.prototype.decrypt=RSADecrypt;function X9ECParameters(a,b,c,d){this.curve=a;this.g=b;this.n=c;this.h=d}function x9getCurve(){return this.curve}function x9getG(){return this.g}
function x9getN(){return this.n}function x9getH(){return this.h}X9ECParameters.prototype.getCurve=x9getCurve;X9ECParameters.prototype.getG=x9getG;X9ECParameters.prototype.getN=x9getN;X9ECParameters.prototype.getH=x9getH;function fromHex(a){return new BigInteger(a,16)}
function secp128r1(){var a=fromHex("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF"),b=fromHex("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC"),c=fromHex("E87579C11079F43DD824993C2CEE5ED3"),d=fromHex("FFFFFFFE0000000075A30D1B9038A115"),e=BigInteger.ONE,a=new ECCurveFp(a,b,c),b=a.decodePointHex("04161FF7528B899B2D0C28607CA52C5B86CF5AC8395BAFEB13C02DA292DDED7A83");return new X9ECParameters(a,b,d,e)}
function secp160k1(){var a=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73"),b=BigInteger.ZERO,c=fromHex("7"),d=fromHex("0100000000000000000001B8FA16DFAB9ACA16B6B3"),e=BigInteger.ONE,a=new ECCurveFp(a,b,c),b=a.decodePointHex("043B4C382CE37AA192A4019E763036F4F5DD4D7EBB938CF935318FDCED6BC28286531733C3F03C4FEE");return new X9ECParameters(a,b,d,e)}
function secp160r1(){var a=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF"),b=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC"),c=fromHex("1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45"),d=fromHex("0100000000000000000001F4C8F927AED3CA752257"),e=BigInteger.ONE,a=new ECCurveFp(a,b,c),b=a.decodePointHex("044A96B5688EF573284664698968C38BB913CBFC8223A628553168947D59DCC912042351377AC5FB32");return new X9ECParameters(a,b,d,e)}
function secp192k1(){var a=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37"),b=BigInteger.ZERO,c=fromHex("3"),d=fromHex("FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D"),e=BigInteger.ONE,a=new ECCurveFp(a,b,c),b=a.decodePointHex("04DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D");return new X9ECParameters(a,b,d,e)}
function secp192r1(){var a=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF"),b=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC"),c=fromHex("64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1"),d=fromHex("FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831"),e=BigInteger.ONE,a=new ECCurveFp(a,b,c),b=a.decodePointHex("04188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF101207192B95FFC8DA78631011ED6B24CDD573F977A11E794811");return new X9ECParameters(a,b,d,e)}
function secp224r1(){var a=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001"),b=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE"),c=fromHex("B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4"),d=fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D"),e=BigInteger.ONE,a=new ECCurveFp(a,b,c),b=a.decodePointHex("04B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34");return new X9ECParameters(a,
b,d,e)}
function secp256r1(){var a=fromHex("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF"),b=fromHex("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC"),c=fromHex("5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B"),d=fromHex("FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"),e=BigInteger.ONE,a=new ECCurveFp(a,b,c),b=a.decodePointHex("046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5");return new X9ECParameters(a,
b,d,e)}function getSECCurveByName(a){return"secp128r1"==a?secp128r1():"secp160k1"==a?secp160k1():"secp160r1"==a?secp160r1():"secp192k1"==a?secp192k1():"secp192r1"==a?secp192r1():"secp224r1"==a?secp224r1():"secp256r1"==a?secp256r1():null}var hexcase=0,b64pad="=";function hex_sha1(a){return rstr2hex(rstr_sha1(str2rstr_utf8(a)))}function b64_sha1(a){return rstr2b64(rstr_sha1(str2rstr_utf8(a)))}function any_sha1(a,b){return rstr2any(rstr_sha1(str2rstr_utf8(a)),b)}
function hex_hmac_sha1(a,b){return rstr2hex(rstr_hmac_sha1(str2rstr_utf8(a),str2rstr_utf8(b)))}function b64_hmac_sha1(a,b){return rstr2b64(rstr_hmac_sha1(str2rstr_utf8(a),str2rstr_utf8(b)))}function any_hmac_sha1(a,b,c){return rstr2any(rstr_hmac_sha1(str2rstr_utf8(a),str2rstr_utf8(b)),c)}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc").toLowerCase()}function rstr_sha1(a){return binb2rstr(binb_sha1(rstr2binb(a),8*a.length))}
function rstr_hmac_sha1(a,b){var c=rstr2binb(a);16<c.length&&(c=binb_sha1(c,8*a.length));for(var d=Array(16),e=Array(16),f=0;16>f;f++)d[f]=c[f]^909522486,e[f]=c[f]^1549556828;c=binb_sha1(d.concat(rstr2binb(b)),512+8*b.length);return binb2rstr(binb_sha1(e.concat(c),672))}function rstr2hex(a){try{hexcase}catch(b){hexcase=0}for(var c=hexcase?"0123456789ABCDEF":"0123456789abcdef",d="",e,f=0;f<a.length;f++)e=a.charCodeAt(f),d+=c.charAt(e>>>4&15)+c.charAt(e&15);return d}
function rstr2b64(a){try{b64pad}catch(b){b64pad=""}for(var c="",d=a.length,e=0;e<d;e+=3)for(var f=a.charCodeAt(e)<<16|(e+1<d?a.charCodeAt(e+1)<<8:0)|(e+2<d?a.charCodeAt(e+2):0),g=0;4>g;g++)c=8*e+6*g>8*a.length?c+b64pad:c+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(f>>>6*(3-g)&63);return c}
function rstr2any(a,b){var c=b.length,d=[],e,f,g,h,k=Array(Math.ceil(a.length/2));for(e=0;e<k.length;e++)k[e]=a.charCodeAt(2*e)<<8|a.charCodeAt(2*e+1);for(;0<k.length;){h=[];for(e=g=0;e<k.length;e++)if(g=(g<<16)+k[e],f=Math.floor(g/c),g-=f*c,0<h.length||0<f)h[h.length]=f;d[d.length]=g;k=h}c="";for(e=d.length-1;0<=e;e--)c+=b.charAt(d[e]);d=Math.ceil(8*a.length/(Math.log(b.length)/Math.log(2)));for(e=c.length;e<d;e++)c=b[0]+c;return c}
function str2rstr_utf8(a){for(var b="",c=-1,d,e;++c<a.length;)d=a.charCodeAt(c),e=c+1<a.length?a.charCodeAt(c+1):0,55296<=d&&56319>=d&&56320<=e&&57343>=e&&(d=65536+((d&1023)<<10)+(e&1023),c++),127>=d?b+=String.fromCharCode(d):2047>=d?b+=String.fromCharCode(192|d>>>6&31,128|d&63):65535>=d?b+=String.fromCharCode(224|d>>>12&15,128|d>>>6&63,128|d&63):2097151>=d&&(b+=String.fromCharCode(240|d>>>18&7,128|d>>>12&63,128|d>>>6&63,128|d&63));return b}
function str2rstr_utf16le(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a.charCodeAt(c)&255,a.charCodeAt(c)>>>8&255);return b}function str2rstr_utf16be(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a.charCodeAt(c)>>>8&255,a.charCodeAt(c)&255);return b}function rstr2binb(a){for(var b=Array(a.length>>2),c=0;c<b.length;c++)b[c]=0;for(c=0;c<8*a.length;c+=8)b[c>>5]|=(a.charCodeAt(c/8)&255)<<24-c%32;return b}
function binb2rstr(a){for(var b="",c=0;c<32*a.length;c+=8)b+=String.fromCharCode(a[c>>5]>>>24-c%32&255);return b}
function binb_sha1(a,b){a[b>>5]|=128<<24-b%32;a[(b+64>>9<<4)+15]=b;for(var c=Array(80),d=1732584193,e=-271733879,f=-1732584194,g=271733878,h=-1009589776,k=0;k<a.length;k+=16){for(var l=d,x=e,v=f,A=g,y=h,m=0;80>m;m++){c[m]=16>m?a[k+m]:bit_rol(c[m-3]^c[m-8]^c[m-14]^c[m-16],1);var B=safe_add(safe_add(bit_rol(d,5),sha1_ft(m,e,f,g)),safe_add(safe_add(h,c[m]),sha1_kt(m))),h=g,g=f,f=bit_rol(e,30),e=d,d=B}d=safe_add(d,l);e=safe_add(e,x);f=safe_add(f,v);g=safe_add(g,A);h=safe_add(h,y)}return[d,e,f,g,h]}
function sha1_ft(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function sha1_kt(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function safe_add(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function bit_rol(a,b){return a<<b|a>>>32-b}
function SM2_rand(){var a=new BigInteger("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",16),b=a.subtract(BigInteger.ONE),c=new SecureRandom;return(new BigInteger(a.bitLength(),c)).mod(b).add(BigInteger.ONE)}
function get_SM2curve(){return new ECCurveFp(new BigInteger("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF",16),new BigInteger("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC",16),new BigInteger("28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93",16))}
function get_SM2G(a){return new ECPointFp(a,a.fromBigInteger(new BigInteger("32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7",16)),a.fromBigInteger(new BigInteger("BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0",16)))}function Ret32Bytes(a){var b=[];if(33==a.length)for(var c=1;33>c;c++)b.push(a[c]);else if(32==a.length)for(c=0;32>c;c++)b.push(a[c]);return b}
function IsPointOnSM2Curve(a,b){var c=!1,d=new BigInteger(a,16),e=new BigInteger(b,16),c=new BigInteger("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF",16),f=new BigInteger("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC",16),g=new BigInteger("28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93",16),h=new BigInteger("2",16),k=new BigInteger("3",16),e=e.modPow(h,c);e.toString(16);k=d.modPow(k,c);d=f.multiply(d).remainder(c);d=k.add(d).remainder(c);
d=d.add(g).remainder(c);d.toString(16);return c=e.equals(d)}
function SM2_encrypt(a,b,c,d){var e=[],f,g,h;if(0==IsPointOnSM2Curve(c,d))return{retErrorCode:-2};for(;;)if(e=SM2_rand(),e.toString(16),f=get_SM2curve(),g=get_SM2G(f).multiply(e),h=HexString2Array(g.getX().toBigInteger().toString(16)),g=HexString2Array(g.getY().toBigInteger().toString(16)),!(32>h.length||32>g.length)){h=Ret32Bytes(h);g=Ret32Bytes(g);h=h.concat(g);f=new ECPointFp(f,f.fromBigInteger(new BigInteger(c,16)),f.fromBigInteger(new BigInteger(d,16)));if(f.isInfinity())return{retErrorCode:-3};
f=f.multiply(e);e=HexString2Array(f.getX().toBigInteger().toString(16));f=HexString2Array(f.getY().toBigInteger().toString(16));if(!(32>e.length||32>f.length)){e=Ret32Bytes(e);f=Ret32Bytes(f);g=e.concat(f);for(var k=!0,l=0;l<g.length;l++)if(0!=g[l]){k=!1;break}if(!k)break}}d=_SM2_KDF(g,g.length,b<<3);if(d.length!=b)return{retErrorCode:-1};c=[];for(g=0;g<b;g++)c[g]=a[g]^d[g];b=[];b=e.concat(a);b=b.concat(f);a=SM3(b,b.length);e=h.concat(a);e=e.concat(c);Array2HexString(e);b=Array2HexString(h);return{retC:e,
retStrC1:b,retC3:a,retC2:c,retErrorCode:0}}
function SM2_decrypt(a,b,c,d){var e;e=get_SM2curve();get_SM2G(e);if(128!=a.length)return{retMDash:null,retErrorCode:-4};a=e.decodePointHex("04"+a);e=a.getX().toBigInteger().toString(16);var f=a.getY().toBigInteger().toString(16);if(0==IsPointOnSM2Curve(e,f))return{retMDash:null,retErrorCode:-2};if(a.isInfinity())return{retMDash:null,retErrorCode:-3};a=a.multiply(d);d=HexString2Array(a.getX().toBigInteger().toString(16));d=Ret32Bytes(d);a=HexString2Array(a.getY().toBigInteger().toString(16));e=Ret32Bytes(a);
if(32!=d.length||32!=e.length)return{retMDash:null,retErrorCode:-1};a=d.concat(e);f=_SM2_KDF(a,a.length,c.length<<3);if(f.length!=c.length)return{retErrorCode:-1};a=[];for(var g=0;g<c.length;g++)a[g]=c[g]^f[g];c=[];c=d.concat(a);c=c.concat(e);c=SM3(c,c.length);for(d=0;d<c.length;d++)if(c[d]!=b[d])return{retMDash:null,retErrorCode:-1};return{retMDash:a,retErrorCode:0}}
function _SM2_sign(a,b){for(var c,d,e=new BigInteger("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",16);;){d=SM2_rand();c=get_SM2curve();c=get_SM2G(c).multiply(d);var f=c.getX().toBigInteger();c.getY().toBigInteger();c=a.add(f).remainder(e);if(!c.equals(BigInteger.ZERO)&&!c.add(d).equals(e)){var f=b.add(BigInteger.ONE).modInverse(e),g=c.multiply(b).remainder(e);d=d.subtract(g).mod(e);d=f.multiply(d).remainder(e);if(!d.equals(BigInteger.ZERO))break}}return{retR:c,retS:d}}
function _SM2_verify(a,b,c,d,e){var f=!1,f=new BigInteger("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",16),g=f.subtract(BigInteger.ONE),h=get_SM2curve(),k=get_SM2G(h);if(0<=a.compareTo(BigInteger.ONE)&&0>=a.compareTo(g)&&0<=b.compareTo(BigInteger.ONE)&&0>=b.compareTo(g)){g=a.add(b).remainder(f);if(g.equals(BigInteger.ZERO))return!1;c=new ECPointFp(h,h.fromBigInteger(c),h.fromBigInteger(d));b=k.multiply(b);c=c.multiply(g);b=b.add(c).getX().toBigInteger();f=e.add(b).remainder(f).equals(a)?
!0:!1}else f=!1;return f}function SM2Sign(a,b,c,d){if(0==a.length||63>b.length||63>c.length||63>d.length)return{retRS:null,retErrorCode:-1};d=new BigInteger(d,16);a=_SM2_CalculateDefaultZValue(HexString2Array(b),HexString2Array(c)).concat(String2UTF8Bytes(a));a=SM3(a,a.length);for(a=new BigInteger(Array2HexString(a),16);!(c=_SM2_sign(a,d),b=c.retR.toString(16),c=c.retS.toString(16),62<b.length&&62<c.length););return{retRS:HexString2Array(b).concat(HexString2Array(c)),retErrorCode:0}}
function SM2Verify(a,b,c,d){if(0==a.length||63>c.length||63>d.length)return{ret:!1,retErrorCode:-1};var e=new BigInteger(c,16),f=new BigInteger(d,16);a=_SM2_CalculateDefaultZValue(HexString2Array(c),HexString2Array(d)).concat(String2UTF8Bytes(a));a=SM3(a,a.length);a=new BigInteger(Array2HexString(a),16);c=new BigInteger(Array2HexString(b.slice(0,32)),16);b=new BigInteger(Array2HexString(b.slice(32)),16);e=_SM2_verify(c,b,e,f,a);return{ret:e,retErrorCode:e?0:-1}}
function CROL(a,b){b&=31;return a<<b|a>>>32-b}function T_TT(a){return 0<=a&&15>=a?2043430169:16<=a&&63>=a?2055708042:0}function FF(a,b,c,d){var e=0;if(0<=d&&15>=d)e=a^b^c;else if(16<=d&&63>=d)e=a&b|a&c|b&c;else return{retErrorCode:-1};return e}function GG(a,b,c,d){var e=0;if(0<=d&&15>=d)e=a^b^c;else if(16<=d&&63>=d)e=a&b|~a&c;else return{retErrorCode:-1};return e}function P0(a){return a^CROL(a,9)^CROL(a,17)}function P1(a){return a^CROL(a,15)^CROL(a,23)}
function ExtendMessage(a){for(var b=0,b=0,c=[0],d=[0],b=0;16>b;b++)c[b]=a[b];for(b=16;68>b;b++)c[b]=P1(c[b-16]^c[b-9]^CROL(c[b-3],15))^CROL(c[b-13],7)^c[b-6];for(b=0;64>b;b++)d[b]=c[b]^c[b+4];return{retW68:c,retW64:d}}function UnsignedAdd(a,b){var c=(a&65535)+(b&65535),d=((a&4294901760)>>>16)+((b&4294901760)>>>16)+(c>>>16)&65535;return d<<16^c&65535}function UnsignedHLAdd(a,b,c,d){return{low:a+c,high:ResultHi}}function combineUINT(a,b){return b<<16^a}
function CF(a,b,c){var d,e,f,g,h,k,l,x,v=0,A=[0,0,0,0,0,0,0,0];d=a[0];e=a[1];f=a[2];g=a[3];h=a[4];k=a[5];l=a[6];x=a[7];for(v=0;64>v;v++){var y=CROL(UnsignedAdd(UnsignedAdd(CROL(d,12),h),CROL(T_TT(v),v)),7),m=y^CROL(d,12),B=0,C=B=0,C=0,B=FF(d,e,f,v),B=UnsignedAdd(UnsignedAdd(UnsignedAdd(B,g),m),c[v]),C=GG(h,k,l,v),C=UnsignedAdd(UnsignedAdd(UnsignedAdd(C,x),y),b[v]);g=f;f=CROL(e,9);e=d;d=B;x=l;l=CROL(k,19);k=h;h=P0(C)}A[0]=d^a[0];A[1]=e^a[1];A[2]=f^a[2];A[3]=g^a[3];A[4]=h^a[4];A[5]=k^a[5];A[6]=l^a[6];
A[7]=x^a[7];return A}function Padding(a,b,c){var d=0,e=0,f=[];if(56>b){for(d=0;64>d;d++)f[d]=0;for(d=0;d<b;d++)f[d]=a[d];f[d]=128;d=c<<3;for(e=7;0<=e;e--)f[56+e]=d&255,d>>>=8}else if(64>=b){for(d=0;128>d;d++)f[d]=0;for(d=0;d<b;d++)f[d]=a[d];f[d]=128;d=c<<3;for(e=7;0<=e;e--)f[120+e]=d&255,d>>>=8}return f}function ConvertBytesArray2UINT32Array(a,b){var c=[];if(0!=(b&3))return c;for(var d=b>>>2,e=0;e<d;e++){for(var f=0,g=0;4>g;g++)f=f<<8^a[(e<<2)+g];c[e]=f}return c}
function SM3_DigestBlock(a,b,c,d){if(64!=d)return{retIV:null,retTotalByteLen:0};var e=[],e=ConvertBytesArray2UINT32Array(c,d);c=[0,0,0,0,0,0,0,0];c=ExtendMessage(e);c=CF(a,c.retW68,c.retW64);a=[0,0,0,0,0,0,0,0];for(e=0;8>e;e++)a[e]=c[e];return{retIV:a,retTotalByteLen:b+d}}function _SM3_CombineUNIT(a,b){return b<<16^a}
function _SM3_DigestInit(){var a=[0,0,0,0,0,0,0,0];a[0]=1937774191;a[1]=1226093241;a[2]=388252375;a[3]=_SM3_CombineUNIT(1536,55946);a[4]=_SM3_CombineUNIT(12476,43375);a[5]=372324522;a[6]=_SM3_CombineUNIT(61005,58253);a[7]=_SM3_CombineUNIT(3662,45307);for(var b=[],c=0;64>c;c++)b[c]=0;return{retIV:a,retTotalLength:0,retBlock:b,retBlockLeftByteLen:0}}
function _SM3_DigestUpdate(a,b,c,d,e,f){var g=0,h=g=0,k=0,l=k=0,h=0;if(64>=d+f){for(g=d;g<d+f;g++)c[g]=e[g-d];return{retIV:a,retTotalLength:b,retBlock:c,retBlockLeftByteLen:d+f}}for(g=d;64>g;g++)c[g]=e[g-d];g=64-d;a=SM3_DigestBlock(a,b,c,64);if(0<f-g){h=f-g>>>6;for(k=0;k<h;k++){b=[];for(d=0;64>d;d++)b.push(e[g+64*k+d]);a=SM3_DigestBlock(a.retIV,a.retTotalByteLen,b,64)}l=f-g&63;for(k=0;k<l;k++)c[k]=e[g+64*h+k];h=l}return{retIV:a.retIV,retTotalLength:a.retTotalByteLen,retBlock:c,retBlockLeftByteLen:h}}
function _SM3_DigestFinal(a,b,c,d,e,f){retUpdate=_SM3_DigestUpdate(a,b,c,d,e,f);c=Padding(retUpdate.retBlock,retUpdate.retBlockLeftByteLen,retUpdate.retTotalLength+retUpdate.retBlockLeftByteLen);a=SM3_DigestBlock(retUpdate.retIV,retUpdate.retTotalLength,c,64);if(64<c.length){d=[];for(b=0;64>b;b++)d[b]=c[64+b];a=SM3_DigestBlock(a.retIV,a.retTotalLength,d,64)}c=[0,0,0,0,0,0,0,0];for(b=0;8>b;b++)c[b]=a.retIV[b];return c}
function _ConvertSM3DigestData2Bytes(a){for(var b=0,c=0,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;8>b;b++)for(var e=a[b],c=3;0<=c;c--)d[4*b+c]=e&255,e>>>=8;return d}function SM3_Init(){return _SM3_DigestInit()}function SM3_Update(a,b,c,d,e,f){return _SM3_DigestUpdate(a,b,c,d,e,f)}function SM3_Final(a,b,c,d,e,f){var g=[0,0,0,0,0,0,0,0];a=_SM3_DigestFinal(a,b,c,d,e,f);return g=_ConvertSM3DigestData2Bytes(a)}
function SM3(a,b){var c=SM3_Init(),c=SM3_Update(c.retIV,c.retTotalLength,c.retBlock,c.retBlockLeftByteLen,a,b);return SM3_Final(c.retIV,c.retTotalLength,c.retBlock,c.retBlockLeftByteLen,a,0)}
function _SM2_KDF(a,b,c){var d=[];if(0<c>>>30)return d;for(var e=1,f=c+256-1>>>8,g=0,h=0,k=0,l=[0,0,0,0],k=e,x=[],g=1;g<=f;g++){for(var h=SM3_Init(),v=SM3_Update(h.retIV,h.retTotalLength,h.retBlock,h.retBlockLeftByteLen,a,b),k=e,h=3;0<=h;h--)l[h]=k&255,k>>>=8;v=SM3_Update(v.retIV,v.retTotalLength,v.retBlock,v.retBlockLeftByteLen,l,4);h=SM3_Final(v.retIV,v.retTotalLength,v.retBlock,v.retBlockLeftByteLen,null,0);for(k=0;k<h.length;k++)x.push(h[k]);e++}if(0==(c&255))for(h=0;h<f<<5;h++)d.push(x[h]);else{a=
(c&255)>>>3;for(h=0;h<f-1<<5;h++)d.push(x[h]);for(k=0;k<a;k++)d.push(x[h+k])}return d}function Hex2Str(a){var b;switch(a){case 0:b="0";break;case 1:b="1";break;case 2:b="2";break;case 3:b="3";break;case 4:b="4";break;case 5:b="5";break;case 6:b="6";break;case 7:b="7";break;case 8:b="8";break;case 9:b="9";break;case 10:b="a";break;case 11:b="b";break;case 12:b="c";break;case 13:b="d";break;case 14:b="e";break;case 15:b="f"}return b}
function Str2Hex(a){var b;switch(a){case "0":b=0;break;case "1":b=1;break;case "2":b=2;break;case "3":b=3;break;case "4":b=4;break;case "5":b=5;break;case "6":b=6;break;case "7":b=7;break;case "8":b=8;break;case "9":b=9;break;case "a":case "A":b=10;break;case "b":case "B":b=11;break;case "c":case "C":b=12;break;case "d":case "D":b=13;break;case "e":case "E":b=14;break;case "f":case "F":b=15}return b}
function Array2HexString(a){for(var b="",c=0;c<a.length;c++)var d=a[c]&15,b=b.concat(Hex2Str((a[c]&240)>>>4)),b=b.concat(Hex2Str(d));return b}function HexString2Array(a){var b=[];0!=(a.length&1)&&(a="0"+a);for(var c=0;c<a.length;c+=2){var d=a.charAt(c),e=a.charAt(c+1),d=Str2Hex(d),e=Str2Hex(e);b.push(d<<4^e)}return b}function stringToBytes(a){for(var b,c,d=[],e=0;e<a.length;e++){b=a.charCodeAt(e);c=[];do c.push(b&255),b>>>=8;while(b);1==c.length&&c.push(0);d=d.concat(c.reverse())}return d}
function unicodeCodePoint2UTF8(a){var b=[];if(0<a>>>31)return b;if(0<=a&&127>=a)b.push(a);else if(128<=a&&2047>=a){var c=a&255,d=128^c<<2>>>2;b.push(192^a>>>8<<2^c>>>6);b.push(d)}else if(2048<=a&&65535>=a){var e=a>>>8,c=a&255,d=128^(e&15)<<2^c>>>6;a=128^c&63;b.push(224^e>>>4);b.push(d);b.push(a)}else if(65536<=a&&1114111>=a){var f=a>>>16,e=a>>>8&255,c=a&255,d=128^(f&3)<<4^e>>>4;a=128^(e&15)<<2^c>>>6;c=128^c&63;b.push(240^f>>>2);b.push(d);b.push(a);b.push(c)}return b}
function UTF82CodePoint(a){var b=0;switch(a.length){case 1:b=a=a[0];break;case 2:var b=(a[0]&28)>>>2,c=(a[0]&3)<<6;a=a[1]&63;b=b<<8^c^a;break;case 3:var d=(a[0]&15)<<4,e=(a[1]&60)>>>2,c=(a[1]&3)<<6;a=a[2]&63;b=(d^e)<<8^c^a;break;case 4:b=(a[0]&7)<<2^(a[1]&48)>>>4;d=(a[1]&15)<<4;e=(a[2]&60)>>>2;c=(a[2]&3)<<6;a=a[3]&63;b=b<<16^(d^e)<<8^c^a;break;default:b=-1}return b}
function UTF8BytesArr2Str(a){for(var b="",c=-1,d=0;d<a.length;){var c=a[d],e=[];if(0==c>>>7)e.push(c),d+=1;else if(6==c>>>5)e=[],e.push(a[d]),e.push(a[d+1]),d+=2;else if(14==c>>>4)e=[],e.push(a[d]),e.push(a[d+1]),e.push(a[d+2]),d+=3;else if(30==c>>>3)e=[],e.push(a[d]),e.push(a[d+1]),e.push(a[d+2]),e.push(a[d+3]),d+=4;else return"";c=UTF82CodePoint(e);b+=String.fromCharCode(c)}return b}
function String2UTF8Bytes(a){for(var b=[],c=0;c<a.length;c++)var d=a.charCodeAt(c),d=unicodeCodePoint2UTF8(d),b=b.concat(d);return b}function _SM2_CalculateZValue(a,b,c,d,e,f,g,h){var k=[],k=[];b<<=3;var l=[0,0];l[0]=b>>>8;l[1]=b&255;k=k.concat(l);k=k.concat(a);k=k.concat(c);k=k.concat(d);k=k.concat(e);k=k.concat(f);k=k.concat(g);k=k.concat(h);return k=SM3(k,k.length)}
function _SM2_CalculateDefaultZValue(a,b){var c=[],c=HexString2Array("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC"),d=HexString2Array("28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93"),e=HexString2Array("32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7"),f=HexString2Array("BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0");return c=_SM2_CalculateZValue([49,50,51,52,53,54,55,56,49,50,51,52,53,54,55,56],16,c,d,e,f,a,b)}
var G_SBOX=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,
206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72];
function _SM4_NLTransform(a){for(var b=0,c=0,c=0,d=[0,0,0,0],e=[0,0,0,0],c=3;0<=c;c--)d[c]=a&255,a>>>=8;e[0]=G_SBOX[d[0]];e[1]=G_SBOX[d[1]];e[2]=G_SBOX[d[2]];e[3]=G_SBOX[d[3]];for(c=0;4>c;c++)b=(b<<8)+e[c];return b}function CROL(a,b){b&=31;return a<<b|a>>>32-b}function _SM4_LTransform(a){var b=0;return b=a^CROL(a,2)^CROL(a,10)^CROL(a,18)^CROL(a,24)}function _SM4_LDashTransform(a){var b=0;return b=a^CROL(a,13)^CROL(a,23)}
function _SM4_TDashTransform(a){var b=0,b=0,b=_SM4_NLTransform(a);return b=_SM4_LDashTransform(b)}function _SM4_TTransform(a){var b=0,b=0,b=_SM4_NLTransform(a);return b=_SM4_LTransform(b)}function _SM4_FTransform(a,b){var c=0,c=0,c=_SM4_TTransform(a[1]^a[2]^a[3]^b);return c^=a[0]}
function _SM4_CipherPlaintextTransform(a,b){var c=[0,0,0,0],d=0,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];for(d=0;32>d;d++){var f=[0,0,0,0];f[0]=e[d];f[1]=e[d+1];f[2]=e[d+2];f[3]=e[d+3];e[d+4]=_SM4_FTransform(f,b[d])}c[0]=e[35];c[1]=e[34];c[2]=e[33];c[3]=e[32];return c}
function _SM4_ExtendKey(a){var b=0,c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=[2746333894,1453994832,1736282519,2993693404],d=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257],e=[0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];e[0]=a[0]^b[0];e[1]=a[1]^b[1];e[2]=a[2]^b[2];e[3]=a[3]^b[3];for(b=0;32>b;b++)a=0,a=_SM4_TDashTransform(e[b+1]^e[b+2]^e[b+3]^d[b]),c[b]=e[b]^a,e[b+4]=c[b];return c}function _SM4_InvertRoundKey(a){for(var b=0,c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;16>b;b++){var d=0,d=a[b];c[b]=a[31-b];c[31-b]=d}return c}
function _SM4_cbc_encrypt(a,b,c,d){var e=0,f=0,g=[0,0,0,0],g=[0,0,0,0],e=[0,0,0,0];if(d){for(e=0;4>e;e++)g[e]=a[e]^c[e];g=_SM4_CipherPlaintextTransform(g,b);for(e=0;4>e;e++)c[e]=g[e]}else{for(f=0;4>f;f++)e[f]=a[f];g=_SM4_CipherPlaintextTransform(a,b);for(f=0;4>f;f++)g[f]^=c[f];for(f=0;4>f;f++)c[f]=e[f]}return{retIV:c,retBlock:g}}
function _Get4UIntsFrom16Bytes(a){var b=[0,0,0,0];if(0==a.length)return null;if(16>a.length)for(var c=16-a.length,d=0;d<c;d++)a.push(c);for(d=0;4>d;d++)b[d]=(a[4*d+0]<<24|a[4*d+1]<<16|a[4*d+2]<<8|a[4*d+3])>>>0;return b}function _TransformUIntArrayToByteArray(a){if(0==a.length)return null;for(var b=[],c=0;c<a.length;c++)b.push(a[c]>>>24&255),b.push(a[c]>>>16&255),b.push(a[c]>>>8&255),b.push(a[c]&255);return b}
function SM4_Encrypt_cbc(a,b,c){var d=0;if(0==a.length||16!=b.length||16!=c.length)return{result:null,errorCode:-1};b=_SM4_ExtendKey(_Get4UIntsFrom16Bytes(b));var e=_Get4UIntsFrom16Bytes(c);for(c=[];d<a.length;d+=16){var f=_SM4_cbc_encrypt(_Get4UIntsFrom16Bytes(a.slice(d,d+16)),b,e,1);c=c.concat(f.retBlock)}0==(a.length&15)&&(a=_SM4_cbc_encrypt([269488144,269488144,269488144,269488144],b,e,1),c=c.concat(a.retBlock));return{result:_TransformUIntArrayToByteArray(c),errorCode:0}}
function SM4_Decrypt_cbc(a,b,c){var d=0;if(0==a.length||16!=b.length||16!=c.length)return{result:null,errorCode:-1};b=_SM4_InvertRoundKey(_SM4_ExtendKey(_Get4UIntsFrom16Bytes(b)));c=_Get4UIntsFrom16Bytes(c);for(var e=[];d<a.length;d+=16)var f=_SM4_cbc_encrypt(_Get4UIntsFrom16Bytes(a.slice(d,d+16)),b,c,0),e=e.concat(f.retBlock);e=_TransformUIntArrayToByteArray(e);return 0==e.length||0==e[e.length-1]||16<e[e.length-1]||e[e.length-1]>=e.length?{result:null,errorCode:-2}:{result:e.slice(0,e.length-e[e.length-
1]),errorCode:0}};
